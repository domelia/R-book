---
title: "Установка и начало работы с R"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(webexercises)
```

## Установка R

Прежде, чем начать работать с R, нам нужно установить его себе на компьютер. Для этого необходимо перейти по ссылке и выбрать версию, подходящую для вашей операционной системы.

Для установки R рекомендуется использовать официальный сайт CRAN (Comprehensive R Archive Network). [Скачать](https://cran.r-project.org/) последнюю стабильную версию (на январь 2026 года это версия 4.5.2).

### Windows

Перейдите на [**CRAN для Windows**](https://cran.r-project.org/bin/windows/base/). Скачайте файл **`R-4.5.2-win.exe`** (около 87 МБ, требует UCRT на Windows 10+). Запустите файл .exe и следуйте инструкциям установщика: соглашайтесь с лицензией, выбирайте путь установки (по умолчанию Program Files) и компоненты. После установки R появится в меню Пуск.

### macOS

Перейдите на [**CRAN для macOS**](https://cran.r-project.org/bin/macosx/). Выберите пакет по архитектуре: **`R-4.5.2-arm64.pkg`** для Apple Silicon (M1/M2+, \~97 МБ) или **`R-4.5.2-x86_64.pkg`** для Intel (\~100 МБ, macOS 11+). Дважды кликните на .pkg файл, следуйте мастеру установки: соглашайтесь с лицензией, выбирайте "Установить для всех" и вводите пароль администратора. Устанавливаются R Framework и R.app GUI.

### Linux (Ubuntu/Debian)

Добавьте репозиторий CRAN:

`sudo apt install r-base r-base-dev -y`

## Установка IDE

Вместе с R устанавливается небольшая консоль, в которой можно набирать команды на R, но работать в ней не очень удобно, поэтому большинство пользователей предпочитает работать со специальным интерфейсом, или интегрированной средой разработки – **Integrated Development Environement, IDE**. Наиболее популярной IDE является RStudio (с другими средами, в которых можно работать в R, такими как Visual Studio, Emacs, Eclipse и другими, Вы можете познакомиться самостоятельно).

Это бесплатная программа, скачать которую можно по ссылке.

<https://posit.co/products/open-source/rstudio/>

Шаги по установке не очень трудны и не потребуют каких-то особых навыков, но на всякий случай, можно обратиться к однму из обучающих видео:


::: callout-note
В комьютерных классах устанавливать ничего не нужно, эти инструкции пригодятся для домашнего использования.
:::

::: callout-tip

### RStudio online

Кроме "стационарного" использования RStudio, компания Posit предоставляет возможность использования облачных технологий для работы с RStudio онлайн. Бесплатный план позволяет создать до 25 проектов и предоставляет 25 часов в месяц вычислительного времени. Этого будет достаточно для наших учебных проектов. Для получения доступа к Posit Cloud необходимо зарегистрироваться на сайте <https://posit.cloud/> или войти с помощью социальных сетей и создать новый проект.
:::

## Начало работы с R и RStudio

После первого запуска RStudio вы, скорее всего, увидите вот такую картину:

![](images/InstallR\menu.jpg)

Основное окно RStudio будет состоять из трех частей (экранов).

Слева находится **консоль** (Console) - здесь можно писать код, и здесь же будут появляться результаты его выполнения, а также различные сообщения, с помощью которых R "общается" с пользователями.

Справа сверху - **рабочее окружение** (Environment) - здесь хранятся создаваемые и загружаемые объекты - данные (вектора, датафреймы и пр.), пользовательские функции и некоторые другие объекты.

Окружение является структурой данных, предназначенной для обеспечения области видимости. Это коллекция каких-то объектов (переменных, функций, массивов данных), которые мы используем. Хэдли Уикхэм предлагает относиться к окружению как к "мешку с именами", :

![](images/InstallR/bag-of-names.png)

Есть четыре типа окружений:

-   *Глобальное* окружение - интерактивное пространство, где мы обычно работаем.

-   *Базовое* окружение, создаваемое базовым пакетом R.

-   *Пустое* окружение, не имеющее никаких имен. Является в большей степени абстракцией, хотя и может быть создано с помощью специальной функции.

-   *Текущее* окружение, то есть то, в котором мы работаем в какой-то момент времени.

    Обычно мы не задумываемся над тем, в каком окружении работаем. Это становится важным тогда, когда возникают конфликты функций и ошибки выполняемого кода. Окружение создается автоматически при запуске программы RStudio.

В этом же окне можно посмотреть **Историю** (History) выполнения кода, и если вы случайно или специально что-то удалили, часто именно в истории можно найти строки, которые были выполнены, и их можно восстановить. Здесь есть некоторые другие вкладки, они нам понадобятся на более поздних этапах работы с R и RStudio.

Справа снизу - **Окно просмотра**. В отдельных вкладках можно посмотреть, какие файлы и папки есть в рабочей директории, какие библиотеки установлены, можно запросить помощь или посмотреть графики (в процессе анализа).

Это только в первый раз окна всего три.

Выберите в меню `File - New File - R Script`:

![](images\InstallR\script.png)

Откроется новый файл, и окон станет четыре:

![](images\InstallR\menu2.png)

В этом новом окне можно писать код и комментарии, сохранять его как отдельный файл с расширением .R, который можно запускать повторно, что очень удобно и позволяет значительно сохранить время при рутинной обработке данных. Очень часто в ходе обработки и анализа данных приходится осуществлять повторяющиеся действия, и скрипт поможет ускорить процесс обработки. В этом состоит основное отличие от консоли, где код можно запустить только однажды.

### Первые простые действия в R

Все естественные языки содержат некоторые правила, описывающие то, как язык должен быть использован, и позволяющие носителям языка понимать друг друга без проблем.

В языках программирования, и в R, в частности, тоже есть такие правила, которые нужно соблюдать для того, чтобы компьютер понял, что от него требуется. В обычном языке правила иногда меняются или не соблюдаются, что не мешает людям понимать друг друга. С R, однако такой номер не пройдет. Правила являются фиксированными, и требуется их неукоснительное соблюдение, чтобы не возникало ошибок.

Рассмотрим некоторые, самые базовые правила.

#### Команды R

Как большинство других языков программирования, R состоит из совокупности команд, формирующих последовательность инструкций, которые выполняет компьютер. Можно условно рассматривать такие команды в качестве глаголов, которые обозначают какие-то действия, которые выполняет R для получения определенного результата.

:::callout-tip
Код набирается либо в консоли, либо в файле скрипта. В консоли его можно запустить, нажав клавишу `Enter`, в скрипте - нажав на кнопку Run в меню или с помощью сочетания клавиш `Ctrl+Enter`.
:::

Например:

```{r echo=TRUE}
print("Привет, мир!")
```

Команда `print()` выполняет вывод на экран сообщения. Код на R обычно содержит множество команд, и обычно, каждая команда распологается на своей строке. Примеры:

```{r print, echo=TRUE}
print("Сегодня хорошая погода")
print(1+1)
print(4 > 5)
```

Первая команда выводит сообщение, вторая - производит математические действия третья - оценивает истинность или ложность утверждения и выводит результат.

Обычно каждая команда находится в своей строке, но можно их писать и в одну строку, разделяя точкой с запятой:

```{r line, echo=TRUE}
x <- 1+1; print(x); print(x^2)
```

В этом примере три команды приведены в одной строке. Первая команда создает переменную `x`, вторая выводит на экран значения этой переменной, третья - вычисляет квадрат значений переменной `x` и выводит результат на экран. Точка с запятой используется в качестве знака окончания команды и подсказывает R, где заканчивается одна команда и начинается другая. Если строка содержит только одну команду, точку с запятой можно не ставить, но если поставить, это не будет ошибкой:

```{r line2, echo=TRUE}
print("Здесь нет точки с запятой")
print("А здесь есть точка с запятой");
```

::: callout-important
Если включить несколько знаков точки с запятой, например, `print(“hello”);;`, ничего работать не будет!
:::

#### Полезные подсказки (shortcuts)

В R создано много удобных вещей, для того, чтобы написание кода было более приятным. Например, если выделить слово и нажать на знак кавычек, они поставятся сразу с двух сторон, то же происходит и со скобками.

Еще одной удобной подсказкой является клавиша `tab`, которая работает с функциями и переменными. Начав набирать какую-то команду или переменную, можно нажать клавишу `tab` и выбрать из списка подходящий вариант, что экономит большое количество времени и позволяет избежать ошибок.

#### Пустые строки

Пустые линии R игнорирует, но они позволяют организовать код и сделать его более читаемым:

```{r line5, echo=TRUE}
print("Какое небо голубое!")
# Пустая строка есть, но она ничего не меняет

print("А трава зеленая!")
```


#### Математические операторы

Довольно часто в процессе обработки данных возникает необходимость вычисления новых переменных, при этом могут потребоваться дополнительные операторы для совершения математических действий. Со сложением и вычитанием все довольно сложно, но что еще?

В таблице ниже представлены основные операторы с примерами их использования:

::: callout-note
|                 |                                       |
|-----------------|---------------------------------------|
| **Оператор**    | **Описание**                          |
| **+**           | сложение                              |
| \-              | вычитание                             |
| **\***          | умножение                             |
| **/**           | деление                               |
| **\^ или \*\*** | возведение в степень                  |
| **x %% y**      | остаток от деления (x mod y) 5%%2 = 1 |
| **x %/% y**     | целая часть при делени 5%/%2 =2       |

:::

Если мы что-то делаем неправильно, в консоли появится сообщение об ошибке:

```{r echo=TRUE, eval=FALSE}

-1+a

```

#### ?

В R имеется очень много сопроводительной документации, доступной по каждой функции и библиотеке, где объясняются особенности работы с ними, приводятся примеры и дается теоретическое обоснование. Чтобы обратиться к этой вспомогательной документации достаточно набрать имя функции, перед которой нужно поставить знак вопроса:

```{r eval=FALSE}
?print
```

Лучше всего эту команду попробовать в RStudio. Давайте сделаем это!

#### ??

Если вдруг вы забыли как точно называется та или иная функция или хотите посмотреть общие материалы по теме, то можно использовать `??`.

```{r, echo=TRUE, eval=FALSE}
??print
```

::: callout-note
Хотите узнать больше о синтаксисе R? Попробуйте набрать ?Syntax в консоли R и нажать на Enter.
:::



#### О пользе ошибок

Ошибок и предупреждающих сообщений бояться не надо, напротив, в таких сообщениях практически всегда находится ответ на вопрос, почему такая ошибка возникла, а часто - и возможное решение проблемы.
:::

#### Работа с пакетами

Мы уже выяснили, что базовый язык R в настоящее время используется наряду с многочисленными функциями и пакетами, разрабатываемыми коллективами ученых и разработчиками из разных стран мира, включая Россию.

Устанавливать новые пакеты нам придется практически на каждом занятии, поэтому лучше научиться делать это сразу.

Пакеты хранятся в основном в двух местах:

-   [CRAN](https://cran.r-project.org/)
-   [Github](https://github.com/) - нечто вроде социальной сети для программистов, где все друг друга знают, создают совместные проекты и делятся кодом.


##### Как установить пакет с помощью CRAN

Чтобы скачать и установить нужную библиотеку с помощью CRAN, проще всего воспользоваться меню RStudio. Нужно выбрать пункт меню **Tools** - **Install Packages:**

![](images\InstallR\install.png)

Затем в окне **Packages** необходимо ввести имя нужной библиотеки, например, `dplyr` и нажать на кнопку **Install**. По умолчанию будет стоять "галочка" - Install Dependencies (установить зависимости) - убирать ее не надо, так как это позволить установить не только саму библиотеку, но и другие библиотеки, от которых она зависит и к которым обращается в ходе выполнения функций. В противном случае, могут возникать ошибки, а оно нам надо?

![](images\InstallR\install2.png)

##### Как установить библиотеку из Github

Не все библиотеки доступны на CRAN, так как эта процедура достаточно сложная и строгая, предполагает несколько проверок (кода, сопроводительной документации). Достаточно частая практика, когда библиотека еще не подана для регистрации на CRAN, разработчики помещают ее на GitHub, откуда ее можно скачать и использовать по назначению. Это позволяет разработчикам получить обратную связь, устранять возможные ошибки, улучшать код.

Чтобы установить нужную библиотеку из GitHub, нам понадобится функция `install_github()`, в которой мы должны указать имя разработчика и название библиотеки. Однако, чтобы выполнить эту функцию, нужен дополнительный пакет `devtools`. Установить ее можно через CRAN с помощью описанного выше способа или через код `install.packages("devtools")`:

```{r, echo=TRUE, eval=FALSE}
install.packages("devtools") # только один раз для установки пакета
library (devtools)
install_github("DeveloperName/PackageName")
```

## Самостоятельная работа

Все самостоятельные работы «зашиты» в отдельный пакет - `r4ssr`, созданный специально для курса «R в социологических исследованиях». 

Поскольку его код расположен на GitHub, воспользуемся следующим кодом:
```{r, echo=TRUE, eval=FALSE, message=FALSE, warning=FALSE}
devtools::install_github("domelia/r4ssr")
```
Кроме пакета с примерами работ, нужно также установить пакет 
Для получения первого опыта нужно будет выполнить работу `Assignment0`. 

Для запуска интерактивной среды запустить следующий код:

```{r, echo=TRUE, eval=FALSE, message=FALSE, warning=FALSE}
learnr::run_tutorial("Assignment0", package="r4ssr")
```

Откроется браузер, необходимо представиться, выполнить задания и сохранить ответы в формате html.
