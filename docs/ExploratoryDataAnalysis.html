<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R в социологических исследованиях - 9&nbsp; Разведочный анализ данных в R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Statistical-Inference.html" rel="next">
<link href="./Base_ggplot2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/iconify-1.0.8/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="include/webex.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ExploratoryDataAnalysis.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Разведочный анализ данных в R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R в социологических исследованиях</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/domelia/R-book/" title="Исходный код" class="quarto-navigation-tool px-1" aria-label="Исходный код"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">В качестве предисловия…</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./About-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Основные сведения об R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Install-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Установка и начало работы с R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data-types-and-structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Типы и структуры данных</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro-to-RMarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Основы работы с R Markdown</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Основы функционального программирования</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ImportExport.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Импорт и экспорт данных</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TidyverseTransformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tidyverse и трансформация данных</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Base_ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Основы визуализации в ggplot2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ExploratoryDataAnalysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Разведочный анализ данных в R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Statistical-Inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Статистический вывод и тестирование исследовательских гипотез</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PCA_CA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Основы многомерного анализа: снижение размерности</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Регрессионный анализ в R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Список источников</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#для-чего-нам-нужен-разведочный-анализ-exploratory-data-analysis" id="toc-для-чего-нам-нужен-разведочный-анализ-exploratory-data-analysis" class="nav-link active" data-scroll-target="#для-чего-нам-нужен-разведочный-анализ-exploratory-data-analysis"><span class="header-section-number">9.1</span> Для чего нам нужен разведочный анализ (Exploratory Data Analysis)</a></li>
  <li><a href="#анализ-характеристик-распределения-количественной-переменной" id="toc-анализ-характеристик-распределения-количественной-переменной" class="nav-link" data-scroll-target="#анализ-характеристик-распределения-количественной-переменной"><span class="header-section-number">9.2</span> Анализ характеристик распределения количественной переменной</a>
  <ul class="collapse">
  <li><a href="#основные-описательные-характеристики" id="toc-основные-описательные-характеристики" class="nav-link" data-scroll-target="#основные-описательные-характеристики"><span class="header-section-number">9.2.1</span> Основные описательные характеристики</a></li>
  <li><a href="#графические-методы-анализа-распределения" id="toc-графические-методы-анализа-распределения" class="nav-link" data-scroll-target="#графические-методы-анализа-распределения"><span class="header-section-number">9.2.2</span> Графические методы анализа распределения</a></li>
  <li><a href="#нахождение-аномальных-наблюдений" id="toc-нахождение-аномальных-наблюдений" class="nav-link" data-scroll-target="#нахождение-аномальных-наблюдений"><span class="header-section-number">9.2.3</span> Нахождение аномальных наблюдений</a></li>
  <li><a href="#проверка-на-нормальность" id="toc-проверка-на-нормальность" class="nav-link" data-scroll-target="#проверка-на-нормальность"><span class="header-section-number">9.2.4</span> Проверка на нормальность</a></li>
  </ul></li>
  <li><a href="#анализ-категориальных-переменных" id="toc-анализ-категориальных-переменных" class="nav-link" data-scroll-target="#анализ-категориальных-переменных"><span class="header-section-number">9.3</span> Анализ категориальных переменных</a>
  <ul class="collapse">
  <li><a href="#описание-таблиц-без-их-представления-в-тексте" id="toc-описание-таблиц-без-их-представления-в-тексте" class="nav-link" data-scroll-target="#описание-таблиц-без-их-представления-в-тексте"><span class="header-section-number">9.3.1</span> Описание таблиц без их представления в тексте</a></li>
  <li><a href="#создание-таблиц-по-нескольким-переменным-возможности-библиотек-gtsummary-и-flextable" id="toc-создание-таблиц-по-нескольким-переменным-возможности-библиотек-gtsummary-и-flextable" class="nav-link" data-scroll-target="#создание-таблиц-по-нескольким-переменным-возможности-библиотек-gtsummary-и-flextable"><span class="header-section-number">9.3.2</span> Создание таблиц по нескольким переменным: возможности библиотек <code>gtsummary</code> и <code>flextable</code></a></li>
  <li><a href="#пример-анализа-вопроса-с-множественными-ответами" id="toc-пример-анализа-вопроса-с-множественными-ответами" class="nav-link" data-scroll-target="#пример-анализа-вопроса-с-множественными-ответами"><span class="header-section-number">9.3.3</span> Пример анализа вопроса с множественными ответами</a></li>
  <li><a href="#таблица-сопряженности-с-множественными-ответами" id="toc-таблица-сопряженности-с-множественными-ответами" class="nav-link" data-scroll-target="#таблица-сопряженности-с-множественными-ответами"><span class="header-section-number">9.3.4</span> Таблица сопряженности с множественными ответами</a></li>
  <li><a href="#графики-для-категориальных-переменных" id="toc-графики-для-категориальных-переменных" class="nav-link" data-scroll-target="#графики-для-категориальных-переменных"><span class="header-section-number">9.3.5</span> Графики для категориальных переменных</a></li>
  </ul></li>
  <li><a href="#самостоятельная-работа" id="toc-самостоятельная-работа" class="nav-link" data-scroll-target="#самостоятельная-работа"><span class="header-section-number">9.4</span> Самостоятельная работа</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/domelia/R-book/edit/main/ExploratoryDataAnalysis.qmd" class="toc-action"><i class="bi bi-github"></i>Редактировать страницу</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Разведочный анализ данных в R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="для-чего-нам-нужен-разведочный-анализ-exploratory-data-analysis" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="для-чего-нам-нужен-разведочный-анализ-exploratory-data-analysis"><span class="header-section-number">9.1</span> Для чего нам нужен разведочный анализ (Exploratory Data Analysis)</h2>
<p><strong>Разведочный анализ</strong> в общем смысле – это предварительный анализ данных с целью выявления наиболее общих зависимостей, закономерностей и тенденций, характера и свойств анализируемых данных, законов распределения анализируемых величин. Именно с разведочного анализа начинается любая обработка данных результатов научного исследования.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/architecture/example-scenario/data/media/exploratory-data-analytics/sandboxing.png" class="img-fluid"></p>
<p>При этом, разведочный анализ - это не какой-то один статистический тест или метод. При разведочном анализе учитывается и сравнивается большое число признаков, а для поиска закономерностей или обоснования имеющихся различий используются самые разные процедуры и техники.</p>
<p>Термин «разведочный анализ» и набор техник, которые применяются для его проведения, был впервые введен и популяризирован американским математиком и статистиком из Принстонского университета <strong>Джоном Тьюки</strong>, написавшим в 1977 году книгу «Разведочный анализ данных» (Exploratory Data Analysis).</p>
<p><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHCBYWFRgWFhYZGBgaGCEaHBwaHCEcGhoaIRocGhoaGhghIS4lHB4rISEaJzgmKy8xNTU1HCQ7QDs0Py40NTEBDAwMBgYGEAYGEDEdFh0xMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMf/AABEIAL4BCQMBIgACEQEDEQH/xAAcAAACAwEBAQEAAAAAAAAAAAADBAECBQYABwj/xABBEAACAQIEBAMECAMHAwUAAAABAgADEQQSITEFQVFhBnGBEyKRoQcyQlKSscHRFFPhFSNicoLw8UPC0hYkRFSD/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANWq8VdTDO+sozwFiSN4UPK1BB5YDSvJaLLLZoBhUtLCtFmeVLwGs94MwKvL+0G8AqvJWpKrrLZRAOrwiPAKJDXgO5pQtFUcwqteBZmlM8sZWBIe8sTAq1jLMw3gWapJ9rFneUapAfSpPO8SSpDF4BC0IlQesCxFgb+nMf8AMoKkB1XkipE1qQgeAz/EGWWvEiZ5ahgOmoYJqkGXMGzEwHKFXWO+1MzqDKFO+a+nT4wvtP8Ad4GQ6wUbq0zFikCloanTvKZYVDA8aUDUSa2H4dWdcyU2I5Ha/lfeZmJR0JV1KtzBFjAXI6SpEvm7SsCpElRpL2nlSBKaQwbrBAS4EAqvPFu8oFg61RU+sQOnfyEBhGB5yyt5TExPF1TkxPl/sxWp4hI2UfP8rQOozQD1NZyr+JXA+zft07DtNPB8VR1Bza8/OBqZpLVNIJdRcWseY/OeZYEk3lSJ4ykC6mXV4EGEohSfeNhY7dQLgeptAYNsgYsCSSMvOw5npCewzE+zuwC5tbA2Fs2l9bduQiCwmbvAIGhEeVxLLmugIQjY8msMwB5gHbtaVV4ByZ5RKrUhkaBNoVXChhlvcWv01vPKwzAHa4v5c5R3vc6bm0CqwntD1lQsmw6QKOYsxhapizNAuBrNnhmDpohxFfVFNkXm7fqP69Jk8Ow7VaiIu7EA9hzPoIz4nxoeoKdM/wB3SGRQNr/aPxFvTvAnHeJMQ7XVii/ZVNAB3O5/LtHcfV/icGKzD+8pMEY/eU2GvxB+M5gdJ0fh9c2Gxaf4A3wDH9IGAi9ZYwRJk3gEkXkSDAuHly4gQYDG4kIjOeXe2uw1gExePWktzvyHX+k52riGe7s+/IXB7AHYekQxOKd2zlgTfRb2AHlKJigCGygHZbDnzJgNYnEZCMy3PRm116mKMztqqmx6aC3p/vaVxVQsczWYne4OYeZkLhnKcwOo29YClbvvfvK5yDoSPIy3s7GxAPyP/Epk6CBvcF4uyMKb6BjoeQJ6dj05GdXmnzyrV1s1hpadV4exgeio+0vut3ts3qIGxmlbyCZVjAkmWEEDCIhJsNTAlTLFoEtPF4D1N3amyAAqhznqt7IfQ+78BAq0ClUrcgkXFj3B3HcQmIplGKNuOmoOlwQehFjAIrw6VNImry6tA0Ebn2lkvFqb6WhUfSBcnWeuZ5IS0BNmgGMgknQazaweBSiorYj/AEU+bnlcdIBKLfwuHLnSvWFk6onNvP8ApOcAh+JY56zl3Op2A2UcgO0TDwDEzovCRv8AxC/eot+v7zls5vOk8FP/AO4K/epsPyMDCnoIsRIDwGBKmCLmQXgEEyvEbf3JGmrC/wCc0TUmdxpgU9bQOWo0dSTsduZJ8o5hXUHLlHmb+Wp6zrfCfgxcQpd2AXYDnf8AaaXGPo+qAD2DhgPs7H+sDgDWANyQT0toR59QeRnkxw2CDz/PWbb+DcSpGemQObDb16TewvhcJYOBci45qRbvs39YHHrhy66Jfyi54S17i689baT61huC01C9etu+0X4twxMjgAXsR3tA+QcST3joPSa3g1dam1gF87m/PppM7ilFkdkbl8xNDwnUszrp7wBHoT+8DpzPGeBkMYEMJenUKMGXcaiDJlqVQA3IuNfytApeTaVzT2eB4mHOTICDdydR90C+x5g6fCKs09TqFWDC2h5i48iOYgGF4RTA+0ub2A7DaNnFgspCIAvIA2PdtbmA4MUgpZFUlmILseQF8qqPXUwAaLgiXUwHEeGziJI0Ln7mA/8A2nSpX9jTzN999bdwJjYnFO7F3Ysep/IDYDtK1GgGeBDtK3lC0jNAveavhrE+zxNNjsWyn1FpkAwiPYgjcajzgMcVolKtRPuuw9L6fK0VnQ4/BnFIteiMzgBaiD61wLBx10mbT4PXY5RRe/dSPmYCV5s4HggKe2rv7KlyJ+s/+VecZTAUcMM+IYPU3WkpvryznkJhcV4i9d87nsqj6qDoogH4nhaQQVKDs6ZspzCzKeWnQzHxIzKR5fnNXBpmw1e32SjelwCYvharGhWpgAqcrk/aBU6a9O3eB0/hOtkw6joT851mGxIInF+HqVqSXOjC4/SblOqUNraQN6pigIjWdLWNgOWky6+L12H4v0gMZxABOXxuYEY3HooIXX1nPV8Yzk3Y2+Utj3d9hYdBv6nlFMmUd+n7wMDxMnvqw6WPlLeGuHMzgKbE6C5AB9TNDimAzoWtqBoP0iOAawCOcrNe3kdAL8oGxUupKtoQSCOhG4lS8EX0ta+g1O+g1kFwANDfnAuZB0OtxKtiSTpp5frKs5OpNz3gTmng0GxlWaAUtKMYJnko8BtR7pa+oIFuxvr8vmJ5WgVe3qLSyGA0jQyxRTDo0BpIWw6wSQl4CFVoAwrbyjiAJjKgy7StoHgYQCDEJAvRxTo2ZHKHqptHanH8Sy2as9vO3zEzWErAvm585R9Z68i8B/gmOWlU98XpuCjj/CefpHqXBHStkHvU6qMqOuoIKllueRuBOfJmrwLjFSjURc5FMuMwOqgE2JHS28DpFC0qKZ9MqD5CNcP4xTdfskHqRf4HX4QlbAiujICL390976Hynz/jvhfFIz60yQLgqSt9eZuLH0gdnxNqJ1Fh6n94OiMOi53IIGpvt8Oc+a4OhXRshYiwudSQDfYX3+U2OM8OrrTT2l1D2K35gjSBoce8V0y9kW4GgC7Dv5TFwvE3Z7uhyk73tb0iR4MzIQHs+bQbKVt8b/KO8P4BdgM50GvS8DosMwdTrpbSZ1Xhys63azql11sC1yfyv6x6mmQZekrjHp5QSrF7e6R9W3fpqYGYzXJlGMlpRoFQJYGDcyQYF2EqRIJkFoHmkDSQWlQ0A5aESBJjtXCsiIzaZwxA2IyuyG48wYEqDCosmmnuFu4H5n9JVGgN04XWCpQ1oA3wiX1qrI/h6X84fCJVosTA0Ww9D+b8pHsMP/Nb8My3MiBrrSw3Oq/ov9IUJheb1Pw/0mIohbQNZjg+tU+glC+E6VflMloMwNn2mE+5V+InjWwdvqVT/qH7zGzSGMDXOIwf8qr+MSDicH/JqfjmKWni0D6X4exS+zVkBCke6CbkAaWJ57TWxWEo1kvVQNbY3KkdswsbThfDmMPsiv3X+R1/O8a4rxpglhppy5wN7CHC03FOnRW9sxAGY22uxNz6mT48wwairW1XW3Kcz4IrV1GIrlA6OVGv1my3OVD6me8S+MEqKEVW00tbUdiIFPD9ChiFKPZXXX3t7HYjtuPSP47hiUl9x1t0F7zksNin9qlW9goy26qbbzVxmNLQLlwfSXwlTC5SK4qlr6ZMtgum9+d7/KZ7Ym2pjPiXIn8MBoXw+v8AidHKue5uR8oDJ/s7riR+AyjU+HnapiB5op/WYJaVYwN04bAn/wCRWHnSB/WQcDgeWLcedE/oZzzPKmpA6FuHYM7Y23nRf9JH9l4X/wC8nrTf9pzrPIDXgdCeD4c7Y6l6o4/SeHAqXLHYf1LD/tnPZp4GB0Z4AN1xWFP+u35ianF+DVKhpk16DMKKA5qoDMxu7PruCWJvznE5pocTxaO6MvKjTQ3+8iKjemkDqsN4fb2bB6lBBmBuagI2I3F4svD8Mv1sXmPRKbH4MSBMvhtUexqjuh/MfrB0R1MDepUcN/NqH/8AMf8AnCezw382r+Bf/OZKQ2aBl1m1gbRipBwF6ggwIwwgWECQ8Jmi2stngXqNBF5LmDYwLM4lGqQLsOsWr4gL38oD14KpiUHPXoJgYvij6jbtFaOILHUwOw4FxjLXCHRX931+z89PWdLiaLgZ3QhDs9rqNxr0Hcz5g9Qk32O46g9Z9b+jnjYxVN6NT7K2b15jsbfEQI4XjMSiDIKITNkX2mY6DTMSugBPYzP43SxT6/wtMvuatNlII881reYvNzBcMCVKmEY2/wCpTvtl2dR5EqR59pn8U8L4lFJXEAqfs7G3nA5ik9TMUdEBG+U3t6jS80FqKEBuITg3hyvXcqgCqD77tsD0H3m7flN3/wBJ4Wkb1nNS2pzfVB6ZR38zAweAYU4jEKqWNjmJ3AtzPYafKav0t4FaOHwbpvTqsgJ1PvoXYnzKXm5wDG0hV/uwqU0BDEiwOh9xT9o3se1pg/TTxEHD4enlKlqxqLm0JVEZScu41dd++kDh6fFEZQScp6co2tQEaEGcijy9PEFTodOXaB1DmUzTJp8ROzaw4xg8oDxaQWiwxIOxni8A5qQRqQLVbQD1IGhQR3+ojP8A5VJ/KFdHQ2dWU/4gV/OILxF7BQ7hQLWDED5TUoVXNFnqlmQnKmYnWp1W+tgL39IDWAxFkfuB+cYR9AeszcGBlYnYD4sb5R8r+QmzQqMFqYd90uw55HQ++ARyK5rjqAeUA9GpGbiZVF43ngDqRZjGmtFqggDJlGMuwgssCrCDqVVXc69Jeq9lM5/EVTcneBpvjRyB9YlXxTdYlUraaQRe8A71zAVajEbyjk8ou7wB1xK4ZtzCVO8oABpAOTedj9FOKyY9VP1XRgfNdV/7pw7CdH9HbXx9C5Omc6f5GgfVfHi1vbUXwwzVA2g2zCxDKTy0J302jXC+EYirZsWwUb+zRr/if9B8Zr0QL5jqbadh0jBxAUXOw1gI8T4h7PLRopY6AW0AB5WmR/ZGKepkZQlPdnzA5t7rbcTTwDh3Dkakk66WHXXbSZvGvFrLdKIBbX3t7DbQQNOlRwuBUkfXtpmNyOdlv9UeU+O/SRxc4mujAkqqG3T3muSO2gm6ntmrCrXZWRWzZG98OOj9u05r6R8SGx9TKMoVVULa2XS9rcrXgc0pI5S2aDNQSLwDh7S/tYqVO8IiGA0lQxuniIgEIjCmAyTfnAv0kA9IQj4wNfgqYYLnqPd76KyFkHQkD6x7E2mi3snD5sTmva16TALY6ZQDYCxIt3nOoukcpAQNXDV6dP3R/ekNnQ2yqHsAMynVgN7aR4VaY9pVD3dwwVCDmVnPvlm2ygZrW3uJiqBCoIGy+CyC+YEBEb8f1V87a+k9cS9XiKuF90glyzjlYFvZhetgx36CaH9r0v5PzEDNrQBjVVIL2cBdhKWhXEpaBncTfKnrMGq99d5vcVS6jzmA9LWABxrKXsbwriAqQJJizbwqmCe8CzCAZ+UYXXnAOlzAtmHI+c7P6KMLnxzNa4Six8iWRR8rziqdJmIVQWYkBVAuWJNgABubz7n9H3hQ4KmzVCDWqgZgNkUXKoDzOpuevlA6tEgcW426bnoI21QATJxFmPvaLe9up7npAzuK8R90pcohXl9Z99AOk5/DuFZnFPQDvoOVz1l8dxEPVZgt+SDkFGgv57+szMTiWtd2sL3sNB5WgbfhrDCpi0NVbUwbqOTVAMy3H3R8yBynyvxXiC+NxL9ajftPpnhLimfEGoRZaaMyg82y2B+BM+VcVxBqYiq5td3YnoDeAqF5wi9Z4LPKsAmrdh+cKg5SqJ06Q6pzgVJJhFBkN0lgIEW1EMDrBousYVBbaBenGKYg1EMkAqGM04sgjCQNXBYEuygsqX111Nty1hsLa3M3vaYP7z/gP7znKOJfKUB0Oh0FyOhbcjtLWgaVQQdoeosC0BZ4EmHqCAMBLiDgKQdyNJhuk1uKJqvkZmhDfaApUSKuk0qifGI1E9DAUK2M9UWFccjJIFu8AFMT2Qk6CHpYYnU6CFdrbaQPrfgHwQmFUYh3WpWdAVK6pTUi/uN9okbt8Od+yqIeU+efRPx8ktgqhvoXpX6f9SmPjmH+qfQMQ5poqs1za2a1sxA3tyMDMxm9y1hOW4txFtQCxB+Bm/xLiKIjl7EnQfvPlniLj4ByJqTz6QNarxMKNheYA4oj4mmKgz0/aJnFyBkzDNt2vMGrinfdjCU6WmsD6pVw+R6pGmjAW8rWnyQ6s3difmZ9aTFCph/anf2QY+YT3vnefLEo6QKKssiwypCrSgUC2HpJojrJq9BCUkgUb60MFlWp6xpaekAFFRftGQkhV1h6aQBrLLLZZYJA8jaw9NoNUhkUwG6Daxu8TorG7QNatABY/UpAyhowEXpwXso+1O0Xr6KYGDxGrrZRe3OIMj77TZaiNesUqqNYGS176m8DVQGabYcE6aT38KB3MDFNC56w64YDfU/KaZoj5RSuusBWo3KBZI5kg2WxgCwmJelUSomjo4dT3BuPT95+ikKYrDq6my1EDqw3UkXBHcH9Z+e/ZC1+s+r/AETcTZqL4dtRTIZT0Vybr+IE+sDivF5q0mdahJZTYLy/zX+7sfWcAbk33N7z7n9JFWkBmdCWyMtxbVSCLG/Qm46T4uKUAKJGaVMkgQi0I7gqcDUwGOK4SqhufddPxafrOcUG/aatVLBxfdh5dYqFtAEqQhHMyQNfSSBc25QBrR37wwTTeSBLgQBhYdRynlT5QqiBQJrDKksiwqCBRUk5YbLLot4AUSGFOFFMCXRYHkWMez7zyIAYxn7QP//Z" class="img-fluid"></p>
<p>Этот термин кажется «сухим» и «занудным», однако практики, используемые в рамках разведочного анализа, не только являются крайне важными, но и весьма волнующими для исследователя. Не случайно, сам Дж. Тьюки сравнил EDA с работой детектива: каждый новое исследование данных представляет собой «мистическую историю», которую мы должны расследовать, вскрыть скрытые свойства и секретные характеристики наших данных.</p>
<p>Основными целями разведочного анализа являются:</p>
<ul>
<li>проникновение в данные и описание их во всей полноте;</li>
<li>выявление основных структур (паттернов) и тенденций;</li>
<li>идентификация взаимосвязей и корреляций между переменными</li>
<li>выбор наиболее важных переменных;</li>
<li>обнаружение отклонений и аномалий;</li>
<li>проверка основных гипотез (предположений);</li>
<li>разработка начальных моделей и подготовка данных для дальнейшего анализа.</li>
</ul>
<p>Результаты разведочного анализа не используются напрямую для выработки управленческих решений, скорее они предоставляют помощь в разработке лучшей стратегии углубленного анализа, способствуют выдвижению новых гипотез, обосновывают возможности применения тех или иных математических методов и моделей. Без разведочного анализа дальнейший анализ данных, часто включающий разработку комплексных статистических моделей, будет производиться практически «вслепую».</p>
<p><strong>Разведочный (эксплораторный, описательный)</strong> анализ данных по своему содержанию, целям и задачам противопоставлен <strong>подтверждающему</strong> анализу данных (Confirmatory Data Analysis), основанному на конкретных предположениях и уже имеющихся данных.</p>
<p>К основным методам разведочного анализа относятся анализ распределений, особенно с помощью методов визуального анализа (гистограмм, диаграмм рассеяния, ящичных диаграмм), тестирование гипотез о соответствии определенному виду распределения, методы группового и корреляционного анализа. Довольно часто к методам разведочного анализа также относят техники, позволяющие осуществить кластеризацию и снизить размерность данных, графически представить высоко-размерные данные, включающие множество переменных, в также предсказательные модели, такие как линейная регрессия, использующие данные и статистические показатели для предсказания целевых показателей. В рамках данного пособия такие методы будут рассмотрены в следующем разделе, посвященном многомерному анализу и возможностям статистического моделирования.</p>
</section>
<section id="анализ-характеристик-распределения-количественной-переменной" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="анализ-характеристик-распределения-количественной-переменной"><span class="header-section-number">9.2</span> Анализ характеристик распределения количественной переменной</h2>
<p>Мы начнем наше разведочное исследование с количественных переменных и затем перейдем к категориальным переменным, двумерному и корреляционному анализу.</p>
<p>Чтобы наши действия были ближе к «социологической жизни», мы будем использовать результаты исследования восприятия и оценки адаптивных стратегий населения в отношении климатических рисков в высокогорных районах Алтая.</p>
<div class="callout-info">
<p>Если Вы не сохранили данные с предыдущих занятий, скачайте их еще раз.</p>
<p>Скачать <a href="https://github.com/domelia/R-book/blob/main/files/База_КлимРиск_2023.sav">данные</a>/</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"files/База_КлимРиск_2023.sav"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Прежде, чем мы начнем «препарировать» наши данные, давайте взглянем на них издалека, в целом. Для этой цели хорошо подойдут библиотеки так называемого автоматизированного разведочного анализа, позволяющие быстро подготовить отчеты сразу по всему массиву данных, представить остовные статистики и графики. В R существует по меньшей мере 10 таких библиотек, наиболее известными из которых являются: - summarytools - DataExplorer - visdat - funModeling - arsenal - dataMaid - dlookr</p>
<p>Подробный анализ данных библиотек в действии, их положительных и отрицательных сторон, можно найти в статье: <em>Mateusz Staniak</em> и <em>Przemysław Biecek</em> <a href="https://arxiv.org/pdf/1904.02101"><strong>The Landscape of RPackages for Automated Exploratory Data Analysis</strong></a>.</p>
<p>Мы воспользуемся некоторыми функциями библиотеки <code>DataExplorer</code>. Для начала установим ее:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DataExplorer"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>После установки, как всегда, загружаем библиотеку в текущую сессию и запускаем ее:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Давайте проведем самый общий анализ по всей базе данных с помощью функции <code>introduce()</code>, которая выдаст нам самые общие сведения: количество строк и колонок (переменных), сколько из них являются дискретными и непрерывными, если такие переменные, в которых все данные пропущены, а также данные о количестве наблюдений и пропущенных значений.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">introduce</span>(df)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td style="text-align: left;">rows</td>
<td style="text-align: right;">913</td>
</tr>
<tr class="even">
<td style="text-align: left;">columns</td>
<td style="text-align: right;">202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">discrete_columns</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">continuous_columns</td>
<td style="text-align: right;">173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">all_missing_columns</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_missing_values</td>
<td style="text-align: right;">30851</td>
</tr>
<tr class="odd">
<td style="text-align: left;">complete_rows</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_observations</td>
<td style="text-align: right;">184426</td>
</tr>
<tr class="odd">
<td style="text-align: left;">memory_usage</td>
<td style="text-align: right;">1854656</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Чтобы визуализировать данную таблицу, можно использовать функцию <code>plot_intro()</code>. На графике отображаются основные показатели набора данных - количество дискретных и непрерывных переменных, полных наблюдений и переменных с отстутствующими значениями.</p>
<p>Почему у нас так много пропусков и нет ни одной строки с полными данными? Все просто: ведь в ходе анализа учитываются абсолютно все переменные набора, включая дополнительные переменные «Другое», которые вполне могли остаться пустыми, если респондент не выбирал данный вариант ответа, а также переменные, предназначенные для определенных категорий респондентов, на которые по определению отвечали не все. Если бы мы отобрали меньшее количество переменных, которые нам нужны для конкретного анализа, результаты были бы совершенно иными. Кроме того, следует учитывать, что при подсчете «дискретных» и «непрерывных» переменных функция руководствуется результатам присвоения категорий данных в SPSS и их импорта в <code>haven</code>. Так что, если изначально тип переменной был задан неверно, то и результаты такого анализа, мягко скажем, не будут соответствовать действительности.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(df)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>В доказательство вышеприведенного тезиса приведем график пропущенных значений по некоторым переменным. Можно легко заметить, что переменные образуют две группы - те, где количество пропусков не составляет выше 5% и переменные, где пропусков существенно больше (обозначены оранжевым цветом). Это ответы на вопрос 9, где спрашивалось о том, каким имуществом владели домохозяйства, проживающие в горных районах (сельхозтехника, сад, огород, пастбище, участки леса и пр.). Нет ничего удивительного в том, что более пятой части опрошенных не обладали ни одним из перечисленных вариантов, более того, часть из них, учитывая, что опрос проводился в зонах экстремального земледелия (приравненных к условиям Крайнего Севера), можно считать признаками высокого статуса и богатства (например, если у жителя есть в пользовании теплица и он может сам выращивать овощи).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df[,<span class="dv">30</span><span class="sc">:</span><span class="dv">50</span>])</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="основные-описательные-характеристики" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="основные-описательные-характеристики"><span class="header-section-number">9.2.1</span> Основные описательные характеристики</h3>
<p>У нас не так много количественных данных, и одной из непрерывных переменных является возраст (<code>age</code>).</p>
<p>Самым простым способом анализа основных характеристик распределения является базовая функция <code>summary()</code>, предоставляющая семь ключевых статистик: минимум, максимум, среднее, медиану, 1-й и 3-й квартили, а также количество пропущенных значений:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
     11      33      42      44      55      91      26 </code></pre>
</div>
</div>
<p>Более расширенный статистический анализ можно получить, обратившись к функции <code>describe()</code>из библиотеки <code>psych</code> (не забываем устанавливать новые библиотеки). Набор аргументов по умолчанию достаточно широк: здесь уже есть и стандартное отклонение, и усеченное среднее, и показатели асимметрии и эксцесса.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(df<span class="sc">$</span>age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">X1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">vars</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">n</td>
<td style="text-align: right;">887.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">44.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">14.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">median</td>
<td style="text-align: right;">42.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">trimmed</td>
<td style="text-align: right;">43.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mad</td>
<td style="text-align: right;">16.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">min</td>
<td style="text-align: right;">11.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max</td>
<td style="text-align: right;">91.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">range</td>
<td style="text-align: right;">80.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">skew</td>
<td style="text-align: right;">0.32</td>
</tr>
<tr class="even">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">-0.39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">se</td>
<td style="text-align: right;">0.49</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Впрочем, каждый из них можно получить отдельно, с помощью базовых функций, например, стандартное отклонение:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(df<span class="sc">$</span>age, <span class="at">na.rm =</span> T)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.57424</code></pre>
</div>
</div>
<p>Дисперсия:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(df<span class="sc">$</span>age, <span class="at">na.rm =</span> T)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 212.4086</code></pre>
</div>
</div>
<p>Асимметрия:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">skew</span>(df<span class="sc">$</span>age, <span class="at">na.rm =</span> T)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3166113</code></pre>
</div>
</div>
</section>
<section id="графические-методы-анализа-распределения" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="графические-методы-анализа-распределения"><span class="header-section-number">9.2.2</span> Графические методы анализа распределения</h3>
<p>Большую роль в анализе данных играет визуализация, и в случае анализа количественных переменных она просто незаменима. Часто именно график, без какого-либо статистического анализа, дает лучшее представление о том, что происходит с данными, тогда как статистические «точечные» оценки, такие как среднее или дисперсия, могут ввести в заблуждение.</p>
<p>Количественную переменную обычно графически представляют несколькими разными способами: - с помощью гистограмм; - с помощью квантильного графика; - с помощью ящичной диаграммы.</p>
<p>Самый быстрый и простой способ получения гистограммы - с помощью базовой функции <code>hist()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>age, <span class="at">col=</span><span class="st">"steelblue"</span>, <span class="at">xlab =</span> <span class="st">"Возраст (лет)"</span>, <span class="at">main=</span><span class="st">"Возраст опрошенных"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Если мы хотим более «продвинутый» вариант гистограммы, можно обратиться к возможностям библиотеки <code>ggstatsplots</code>, основанной на философии создания визуальных материалов в рамках библиотеки <code>ggplot2</code> и предназначенной для создания публикабельных визуализаций, сопровожденной результатами статистического анализа и возможностями проверки статистических гипотез. При несколько излишней сложности, это, пожалуй, лучшее, что есть сегодня в плане описательного анализа. Это не просто библиотека, создающая графики, это одновременно и способ визуализации, и способ проведения статистического анализа, включая представление регрессионных моделей и мета-анализ.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">gghistostats</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data            =</span> df,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x               =</span> age,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab            =</span> <span class="st">"Возраст"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">effsize.type =</span> <span class="st">"d"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">test.value =</span> <span class="fl">40.4</span> <span class="co">#Протестируем гипотезу об отличии среднего возраста по выборке от среднего возраста россиян</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Результаты визуального анализа указывают на то, что наше среднее (44,0 года) довольно сильно отклоняется от общероссийских данных, что было протестировано с помощью одновыборочного t-критерия. Однако, довольно заметно, что у наших данных положительная асимметрия и довольно длинный «хвост» из больших значений. Попробуем робастный подход, где вместо среднего используется усеченное среднее (по умолчанию в настройках указывается значение «усечения» - 0.2), а для подсчета p-значения при сравнении средних используется метод [бутстрэпа](https://ru.wikipedia.org/wiki/%D0%91%D1%83%D1%82%D1%81%D1%82%D1%80%D1%8D%D0%BF_(%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0). Результаты неутешительные - различия по-прежнему значимые.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">gghistostats</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data            =</span> df,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x               =</span> age,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab            =</span> <span class="st">"Возраст"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">effsize.type =</span> <span class="st">"d"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"robust"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">test.value =</span> <span class="fl">40.4</span> <span class="co">#Протестируем гипотезу об отличии среднего возраста по выборке от среднего возраста россиян</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Еще один очень важный график: квантильный или Q-Q plot.</p>
<p>Архитектура этого графика проста: по оси x откладываются квантили для эмпирических данных, а по оси y - квантили распределения, с которыми мы их сравниваем (обычно - нормальное). Таким образом, Q-Q plot это диаграмма рассеяния, в которой два набора квантилей представлены друг напротив друга. Если оба они происходят из одного распределения, мы увидим точки, формирующие прямую.</p>
<p>Что такое квантиль?</p>
<p>Квантиль — это одна из точек, делящих функцию плотности распределения на участки, вероятность попадания в которые одинакова, то есть на участки одинаковой площади.</p>
<p><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/ced/171/7c6/ced1717c6ccf73d530fa4fedc8532e87.png" class="img-fluid"></p>
<p><strong>Квантильная функция</strong> — это функция, которая по значению вероятности <code>P</code> возвращает такое число (квантиль) <code>q</code>, что вероятность того, что случайная величина примет значение меньше <code>q</code> равняется <code>P</code>:</p>
<p><img src="https://habrastorage.org/getpro/habr/upload_files/233/dca/709/233dca7099c3c5e4085256e671d9c832.svg" class="img-fluid"> В базовом R, чтобы создать такой график, нужно соединить две функции - <code>qqnorm () и</code>qqline()`. Одна создает, собственно квантильный график, другая - референтную прямую, на которую можно ориентироваться при оценке полученных значений.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(df<span class="sc">$</span>age, <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(df<span class="sc">$</span>age, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Как всегда, могут быть и другие варианты. На мой личный вкус один из лучших QQ-plot создается в библиотеке <code>ggpubr</code>, позволяющей добавить на график доверительные интервалы для квантилей, а также выбрать тему, применить трансформации к шкалам (“log2”, “log10”, “sqrt”), изменить другие настройки:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggqqplot</span>(df, <span class="at">x =</span> <span class="st">"age"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Еще одна форма графического представления количественных данных - ящичная диаграмма.</p>
<p>Анатомию данного графика лучше представить в визуальном виде (см. рисунок ниже). В центре графика - медиана, сам «ящик» формируется на основе межквартильного размаха (IQR), а «усы» ограничиваются либо минимальным и максимальным значениями, либо границами <code>Q3+1,5*IQR</code>и <code>Q1-1,5*IQR</code>, если в распределении имеются выбросы.</p>
<p><img src="https://builtin.com/sites/www.builtin.com/files/styles/ckeditor_optimize/public/inline-images/1_boxplots.jpg" class="img-fluid"> Можно воспользоваться простой функцией `boxplot(), либо использовать более изощренные варианты.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(df<span class="sc">$</span>age, <span class="at">col=</span><span class="st">"steelblue"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">y=</span>age, <span class="at">fill=</span><span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="нахождение-аномальных-наблюдений" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="нахождение-аномальных-наблюдений"><span class="header-section-number">9.2.3</span> Нахождение аномальных наблюдений</h3>
<p>Уже на гистограмме и квантиль-квантильном графе хорошо видны все «огрехи» распределения, а ящичная диаграмма даже выносит особые наблюдения («статистические выбросы») за пределы основного графика.</p>
<p>Мы могли бы представить в виде диаграммы стандартизированные значения, и сразу понять, сколько и как много в нашей выборке наблюдений, превышающих допустимый предел (например, лежащих далее, чем 3 «сигмы» от нулевого значения):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_age <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>age)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>z_age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Давайте посмотрим на описательные статистики:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>z_age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       V1         
 Min.   :-2.2644  
 1st Qu.:-0.7549  
 Median :-0.1374  
 Mean   : 0.0000  
 3rd Qu.: 0.7546  
 Max.   : 3.2247  
 NA's   :26       </code></pre>
</div>
</div>
<p>Мы видим, что у нас нет маленьких значений за пределами «-3», но есть некоторые значения, превышающие «+3).</p>
<p>Мы можем посмотреть номера (строки) этих наблюдений:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(df<span class="sc">$</span>z_age <span class="sc">&gt;</span> <span class="fl">3.0</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 562 593 872</code></pre>
</div>
</div>
<p>Таких значений три - 562, 593, 872. Это серьезные долгожители:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">562</span>,<span class="dv">593</span>,<span class="dv">872</span>),]<span class="sc">$</span>age</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 91 89 91
attr(,"label")
[1] "Возраст"
attr(,"format.spss")
[1] "F8.0"
attr(,"display_width")
[1] 10</code></pre>
</div>
</div>
<p>Вопрос о том, как выявлять аномальные значения и что с ними делать, не является тривиальным. Помимо графических методов, есть и специальные статистические методы, позволяющие вычленить наблюдения, содержащие нетипичные значения.</p>
<section id="фильтр-хэмпеля" class="level4" data-number="9.2.3.1">
<h4 data-number="9.2.3.1" class="anchored" data-anchor-id="фильтр-хэмпеля"><span class="header-section-number">9.2.3.1</span> Фильтр Хэмпеля</h4>
<p>Так, еще один метод, известный как фильтр Хэмпеля, рассматривает в качестве выбросов значения, попадающих в интервал (<span class="math inline">\(I\)</span>), образуемый медианой плюс или минус три абсолютных отклонения от медианы (median absolute, MAD):</p>
<p><span class="math display">\[I = [median - 3 \cdot MAD; median + 3 \cdot MAD]\]</span> где <span class="math inline">\(MAD\)</span> определяется как:</p>
<p><span class="math inline">\(MAD = median(|X_i - \tilde{X}|)\)</span></p>
<p>Давайте определим нижнюю и верхнюю границы фильтра и отберем наблюдения, которые не попадают в указанный диапазон:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> <span class="fu">median</span>(df<span class="sc">$</span>age, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">mad</span>(df<span class="sc">$</span>age, <span class="at">na.rm=</span>T, <span class="at">constant =</span> <span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>lower_bound</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> <span class="fu">median</span>(df<span class="sc">$</span>age, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">mad</span>(df<span class="sc">$</span>age, <span class="at">na.rm=</span>T, <span class="at">constant =</span> <span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>upper_bound</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>outlier_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(df<span class="sc">$</span>age <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> df<span class="sc">$</span>age <span class="sc">&gt;</span> upper_bound)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>outlier_ind</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  38 421 462 503 525 529 556 562 583 584 593 601 809 866 872</code></pre>
</div>
</div>
<p>Легко увидеть, что наблюдений гораздо больше, чем было выявлено с помощью z-значений, что указывает на то, что фильтр Хэмпеля является довольно консервативным подходом.</p>
</section>
<section id="статистические-тесты-для-выявления-аномалий" class="level4" data-number="9.2.3.2">
<h4 data-number="9.2.3.2" class="anchored" data-anchor-id="статистические-тесты-для-выявления-аномалий"><span class="header-section-number">9.2.3.2</span> Статистические тесты для выявления аномалий</h4>
<p>Кроме графических методов и механического отбора, нетипичные наблюдения можно выявлять и с помощью специальных тестов, например, таких как:</p>
<ul>
<li>Тест Груббса</li>
<li>Тест Диксона</li>
<li>Тест Роснера</li>
</ul>
<p>Эти три статистических теста являются частью более формальных техник нахождения выбросов, так как они основаны на вычислении тестовой статистики, которая сопоставляется с табличными критическими значениями, основанными на объеме выборки и определяемого доверительного уровня).</p>
<section id="grubbss-test" class="level5" data-number="9.2.3.2.1">
<h5 data-number="9.2.3.2.1" class="anchored" data-anchor-id="grubbss-test"><span class="header-section-number">9.2.3.2.1</span> Grubbs’s test</h5>
<p>Тест Груббса позволяет сделать вывод о том, являются ли максимальное и минимальное значение выбросами.</p>
<p><span class="math inline">\(H_0\)</span>: максимальное значение <strong>не</strong> является аномальным. <span class="math inline">\(H_1\)</span>: максимальное значение является аномальным.</p>
<p>Аналогичным образом формулируются гипотезы о минимальных значениях:</p>
<p><span class="math inline">\(H_0\)</span>: минимальное значение <strong>не</strong> является аномальным. <span class="math inline">\(H_1\)</span>: минимальное значение является аномальным.</p>
<p>Как и для любого статистического теста, мы решаем, если p-значение меньше выбранного уровня значимости (чаще всего α=0,05) нулевая гипотеза отклоняется и мы делаем вывод, о том, что значения являются выбросами.</p>
<p>Этот тест не подходит для выборок, в которых содержится менее 6 наблюдений.</p>
<p>Чтобы выполнить тест Груббса в R, мы будем использовать функцию <code>grubbs.test()</code> из библиотеки <code>{outliers}</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("outliers")</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(outliers)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">grubbs.test</span>(df<span class="sc">$</span>age, <span class="at">type=</span><span class="dv">10</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Grubbs test for one outlier

data:  df$age
G = 3.22471, U = 0.98825, p-value = 0.5426
alternative hypothesis: highest value 91 is an outlier</code></pre>
</div>
</div>
<p>Тест «говорит» нам о том, что максимальное значение не является выбросом.</p>
<p><iconify-icon inline="" icon="arcticons:writer" style="font-size: 42px;"></iconify-icon> <strong>Самостоятельное задание</strong>:</p>
<p>Проверьте, является ли выбросом минимальное значение. Для этого в настройках установите opposite = TRUE. Проверьте гипотезу о принадлежности к выбросам обоих - минимального и максимального значений. Поменяйте настройки на type=11.</p>
</section>
<section id="тест-диксона" class="level5" data-number="9.2.3.2.2">
<h5 data-number="9.2.3.2.2" class="anchored" data-anchor-id="тест-диксона"><span class="header-section-number">9.2.3.2.2</span> Тест Диксона</h5>
<p>Подобно тесту Груббса, тест Диксона используется для определения того, является ли минимальное или максимальное значение выбросом. Если у нас есть подозрение относительно других значений, мы должны тестировать их индивидуально.</p>
<p>Еще одно ограничение: этот тест хорошо работает только на маленьких выборках (n≤25).</p>
<p>Чтобы попробовать этот метод на наших данных, мы должны сократить нашу выборку и использовать соответствующую функцию из той же библиотеки:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>subdat <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">dixon.test</span>(subdat<span class="sc">$</span>age)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Dixon test for outliers

data:  subdat$age
Q = 0.31579, p-value = 0.5913
alternative hypothesis: lowest value 22 is an outlier</code></pre>
</div>
</div>
</section>
<section id="тест-роснера" class="level5" data-number="9.2.3.2.3">
<h5 data-number="9.2.3.2.3" class="anchored" data-anchor-id="тест-роснера"><span class="header-section-number">9.2.3.2.3</span> Тест Роснера</h5>
<p>К теста Роснера есть несколько преимуществ: - его можно использовать для вычленения нескольких выбросов за один раз - позволяет решать проблемы маскировки, когда один выброс, близкий по значению к другому выбросу, остается незамеченным - подходит для больших выборок. <code>В R функция</code>rosnerTest()<code>находится в библиотеке</code>{EnvStats}`. Функция требует по меньшей мере двух аргументов: ссылки на данные и количество выбросов (по умолчанию 3).</p>
<p>Формула теста следующая: Наблюдаемые значения сортируются от меньшего к большему, далее определяется максимальное значение выбросов (не больше 10), и затем считается серия статистических тестов, путем последовательного удаления значений (высоких или низких), которые максимально удалены от среднего значения и пересчета стандартных значений по формуле:</p>
<p><span class="math display">\[\large R_{i+1} = \frac{|x^{(i)} - \bar x^{(i)}|}{s^{(i)}}\]</span> Как только все статистики $ R_1…R_k$ посчитаны, начинается проверка гипотез путем сопоставления с критическими значениями для определенного уровня значимости.</p>
<p>Попробуем провести этот тест на наших данных:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("EnvStats")</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">rosnerTest</span>(df<span class="sc">$</span>age,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">3</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Results of Outlier Test
-------------------------

Test Method:                     Rosner's Test for Outliers

Hypothesized Distribution:       Normal

Data:                            df$age

Number NA/NaN/Inf's Removed:     26

Sample Size:                     887

Test Statistics:                 R.1 = 3.224713
                                 R.2 = 3.245654
                                 R.3 = 3.128295

Test Statistic Parameter:        k = 3

Alternative Hypothesis:          Up to 3 observations are not
                                 from the same Distribution.

Type I Error:                    5%

Number of Outliers Detected:     0

  i   Mean.i     SD.i Value Obs.Num    R.i+1 lambda.i+1 Outlier
1 0 44.00225 14.57424    91     562 3.224713   4.010252   FALSE
2 1 43.94921 14.49655    91     872 3.245654   4.009971   FALSE
3 2 43.89605 14.41806    89     593 3.128295   4.009690   FALSE</code></pre>
</div>
</div>
<p>Видим, что результаты также схожи с теми, что мы получили в ходе анализа стандартизированных значений, что неудивительно, учитывая сходство статистических процедур.</p>
</section>
</section>
</section>
<section id="проверка-на-нормальность" class="level3" data-number="9.2.4">
<h3 data-number="9.2.4" class="anchored" data-anchor-id="проверка-на-нормальность"><span class="header-section-number">9.2.4</span> Проверка на нормальность</h3>
<p>Подчиняются ли анализируемые количественные переменные закону нормального распределения вероятностей? Очень многие статистические методы предполагают положительный ответ на этот вопрос, и поэтому проверка исследуемых переменных на нормальность распределения является важной составной частью разведочного анализа данных.</p>
<p>Как известно, кривая нормального распределения имеет красивый «колоколообразный вид» и описывается формулой функции плотности вероятности (probability density function, PDF):</p>
<p><span class="math display">\[f(x) = \frac{e^{-(x - \mu)^{2}/(2\sigma^{2}) }} {\sigma\sqrt{2\pi}}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Например, мы желаем проверить гипотезу о равенстве средних значений в двух независимых выборках. Для этой цели подходит критерий Стьюдента. Но применение критерия Стьюдента обосновано, только если данные подчиняются нормальному распределению. Поэтому перед применением критерия необходимо проверить гипотезу о нормальности исходных данных. Или проверка остатков линейной регрессии на нормальность — позволяет проверить, соответствует ли применяемая модель регрессии исходным данным.</p>
<p>Нормальное распределение естественным образом возникает практически везде, где речь идет об измерении с ошибками. Более того, в силу центральной предельной теоремы, распределение многих выборочных величин (например, выборочного среднего) при достаточно больших объемах выборки хорошо аппроксимируется нормальным распределением вне зависимости от того, какое распределение было у выборки исходно.</p>
<p>Проверяя условие нормальности распределения данных, необходимо, однако, хорошо представлять себе, в каких случаях его выполнение является критическим для применения конкретного статистического метода. Так, например, метод главных компонент (Principle Components Analysis, PCA) не требует, чтобы данные были распределены нормально. Линейная регрессия (Linear Regression) хотя и предполагает нормальность распределения зависимой переменной, является достаточно робастным методом при незначительных отклонениях от этого условия. В то же время для успешного применения дискриминантного анализа (Discriminant Analysis) нормальность распределениях признаков в каждой группе классифицируемых объектов - условие обязательное (Мастицкий, 2012).</p>
<p>Проверку выборки на нормальность можно производить несколькими путями.</p>
<ul>
<li>Большое распространение получили графические методы – анализ распределения с помощью гистограммы, диаграммы плотности, визуально показывающие, насколько велики отклонения от нормальности.</li>
</ul>
<p>Мы уже строили для наших данных квантиль-квантиль график, гистограмму и ящичную диаграмму. Пожалуй, единственный график, который мы еще не делали - график плотности.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>age)) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>)<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Можно использовать и данные описательных статистик, помня как в нормальном распределении соотносятся среднее, мода, медиана, какими должны быть асимметрия и эксцесс, выполняется ли «правило 3-х сигм». Обычно обращают внимание на показатели асимметрии и эксцесса, анализируют их абсолютные значения и сравнивают их со стандартными ошибками. Выше мы пробовали функцию <code>describe()</code> из библиотеки <code>psych</code>. Еще один хороший вариант - функция <code>Desc()</code> из библиотеки <code>DescTools</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Desc</span>(df<span class="sc">$</span>age, <span class="at">plotit =</span> <span class="cn">TRUE</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>------------------------------------------------------------------------------ 
df$age (numeric) :
  Возраст


  length      n    NAs  unique     0s   mean  meanCI'
     913    887     26      74      0  44.00   43.04
          97.2%   2.8%           0.0%          44.96
                                                    
     .05    .10    .25  median    .75    .90     .95
   22.00  26.00  33.00   42.00  55.00  63.00   68.00
                                                    
   range     sd  vcoef     mad    IQR   skew    kurt
   80.00  14.57   0.33   16.31  22.00   0.32   -0.39
                                                    
lowest : 11.0, 13.0, 14.0, 15.0 (2), 16.0 (6)
highest: 82.0 (2), 85.0, 86.0, 89.0, 91.0 (2)

' 95%-CI (classic)</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Отдельно можно посчитать показатели асимметрии и эксцесса вместе с доверительными интервалами. У нормального распределения они должны быть близкими к нулю.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Negative_and_positive_skew_diagrams_%28English%29.svg/669px-Negative_and_positive_skew_diagrams_%28English%29.svg.png" class="img-fluid"> <img src="https://img.tfd.com/mk/K/X2604-K-11.png" class="img-fluid"></p>
<p>Асимметрия:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Skew</span>(df<span class="sc">$</span>age, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">ci.type =</span> <span class="st">"classic"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  skewness     lwr.ci     upr.ci 
 0.3166113 -0.1603833  0.1603833 </code></pre>
</div>
</div>
<p>Эксцесс:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Kurt</span>(df<span class="sc">$</span>age, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="dv">2</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">ci.type =</span> <span class="st">"classic"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  kurtosis     lwr.ci     upr.ci 
        NA -0.3169093  0.3169093 </code></pre>
</div>
</div>
<ul>
<li>особая группа методов — критерии нормальности. Их существует множество - по меньшей мере 15. Подробные материалы про все критерии с формулами и нюансами интерпретации можно посмотреть <a href="https://yadi.sk/i/QwrWjkIkrKAwF">вот здесь</a></li>
</ul>
<p>В R реализованы практически все имеющиеся тесты на нормальность — либо в виде стандарных функций, либо в виде функций, входящих в состав отдельных пакетов. Примером базовой функции является <code>shapiro.test()</code>, при помощи которой можно выполнить широко используемый тест Шапиро-Уилка</p>
<section id="тест-шапиро-уилка" class="level4" data-number="9.2.4.1">
<h4 data-number="9.2.4.1" class="anchored" data-anchor-id="тест-шапиро-уилка"><span class="header-section-number">9.2.4.1</span> Тест Шапиро-Уилка</h4>
<p>Тест Шапиро-Уилка был впервые опубликован в 1965 году Самюэлем Санфордом Шапиро и Мартином Уилком.</p>
<p><span class="math display">\[W=\frac{(\Sigma^n_{i=1}a_ix_{(i)})^2}{\Sigma^n_{i=1}(x_i-\bar{x})^2}\]</span> где:</p>
<p><span class="math inline">\(x_i\)</span> – упорядоченные значения анализируемой переменной <span class="math inline">\(a_i\)</span> – константы, созданные на основе ковариаций, дисперсий и средних значений по выборке (размера <span class="math inline">\(n\)</span>) из нормального распределения (обычно берутся из таблиц).</p>
<p>Считается одним из лучших и наиболее мощных тестов.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(df<span class="sc">$</span>age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  df$age
W = 0.98589, p-value = 1.545e-07</code></pre>
</div>
</div>
<p>Основные классические критерии проверки на нормальность собраны в пакете <code>nortest</code>. Пакет можно установить с CRAN при помощи вызова функции <code>install.packages()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"nortest"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="тест-колмогорова-смирнова" class="level4" data-number="9.2.4.2">
<h4 data-number="9.2.4.2" class="anchored" data-anchor-id="тест-колмогорова-смирнова"><span class="header-section-number">9.2.4.2</span> Тест Колмогорова-Смирнова</h4>
<p>наверное, одним из самых известных является тест Колмогорова-Смирнова, носящий имена российских математиков Андрея Николаевича Колмогорова и Николая Васильевича Смирнова.</p>
<p>Статистика <span class="math inline">\(D\)</span> Колмогорова-Смирнова вычисляется как максимум модуля разности между эмпирической и теоретической функциями распределения. Эта статистика критерия согласия используется для проверки гипотезы о том, что наблюдения взяты из указанного распределения:</p>
<p><span class="math display">\[D = \max_{1 \le i \le N} \left( F(Y_{i}) -
               \frac{i-1} {N}, \frac{i}{N} - F(Y_{i}) \right)\]</span> где <span class="math inline">\(F\)</span> является теоретическим кумулятивным распределением, которое должно обязательно принадлежать к семейству непрерывных распределений. Нулевая гипотеза отклоняется в случае, если тестовая статистика, <span class="math inline">\(D\)</span>, превышает критическое значение.</p>
<p>Когда данные сравниваются с теоретическим нормальным распределением, используется поправка Лиллиефорса.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">lillie.test</span>(df<span class="sc">$</span>age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  df$age
D = 0.063661, p-value = 4.699e-09</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(<span class="fu">scale</span>(df<span class="sc">$</span>age)), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">main=</span><span class="st">"Эмпирическая и теоретическая кумулятивные функции"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(pnorm, <span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="тест-андерсона-дарлинга" class="level4" data-number="9.2.4.3">
<h4 data-number="9.2.4.3" class="anchored" data-anchor-id="тест-андерсона-дарлинга"><span class="header-section-number">9.2.4.3</span> Тест Андерсона-Дарлинга</h4>
<p>Тест Андерсона-Дарлинга (Stephens, 1974) используется для тестирования гипотезы о том, что выборочные данные имеют специфическое распределение. Это модификация теста Колмогорова-Смирнова (K-S test), в которой больший вес придается крайним значениям (хвостам), по сравнению с оригинальным тестом</p>
<p>Формула для вычисления критерия такова:</p>
<p><span class="math display">\[A^{2} = -N - S\]</span></p>
<p><span class="math display">\[S = \sum_{i=1}^{N}\frac{(2i - 1)}{N}[\ln{F(Y_{i})} + \ln{(1 - F(Y_{N+1-i}))}]\]</span></p>
<p>где <span class="math inline">\(F\)</span> - это кумулятивная функция распределения, показывающая вероятность того, что целевое значение меньше указанного значения либо равно ему.</p>
<p>В библиотеке <code>nortest</code> тест Андерсона-Дарлинга реализован в функции <code>ad.test()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">ad.test</span>(df<span class="sc">$</span>age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  df$age
A = 3.7285, p-value = 2.644e-09</code></pre>
</div>
</div>
</section>
<section id="тест-крамера-фон-мизеса" class="level4" data-number="9.2.4.4">
<h4 data-number="9.2.4.4" class="anchored" data-anchor-id="тест-крамера-фон-мизеса"><span class="header-section-number">9.2.4.4</span> Тест Крамера-фон-Мизеса</h4>
<p>Тест Крамера-фон-Мизеса является еще одной альтернативой тесту Колмогорова-Смирнова и представляет собой комплексный тест для проверки нормальности. Он использует сумму квадратов различий между наблюдаемыми и ожидаемыми кумулятивными пропорциями в качестве тестовой статистики.</p>
<p>Тест имеет следующую формулу:</p>
<p><span class="math display">\[\begin{align}
W_n^2:=n\int(F_n(x)-F_0(x))^2\,\mathrm{d}F_0(x).
\end{align}\]</span></p>
<p>Если <span class="math inline">\(H_0: F=F_0\)</span> справедливо, то <span class="math inline">\(W^2_n\)</span> являются маленькими значениями. Соответственно, отвержение гипотезы происходит при больших значениях <span class="math inline">\(W^2_n\)</span>. Считается, что тест Крамера-фон-Мизеса более мощный, по сравнению с классическим тестом Колмогорова-Смирнова.</p>
<p>В библиотеке <code>nortest</code> для теста Крамера-фон-Мизеса используется функция <code>cvm.test()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">cvm.test</span>(df<span class="sc">$</span>age)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Cramer-von Mises normality test

data:  df$age
W = 0.68776, p-value = 7.727e-08</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="анализ-категориальных-переменных" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="анализ-категориальных-переменных"><span class="header-section-number">9.3</span> Анализ категориальных переменных</h2>
<p>Рассмотрев возможности разведочного анализа количественных переменных, перейдем к категориальным данным, представленным в номинальных и порядковых шкалах</p>
<section id="описание-таблиц-без-их-представления-в-тексте" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="описание-таблиц-без-их-представления-в-тексте"><span class="header-section-number">9.3.1</span> Описание таблиц без их представления в тексте</h3>
<p>Во многих случаях в ходе анализа нам нужны просто цифры, ведь не все результаты представляются в виде таблиц и графиков, что-то просто описывается словами, поэтому иногда проще и быстрее использовать базовый код, без премудростей.</p>
<p>Представим ситуацию, что мы описываем нашу выборочную совокупность и хотим представить информацию по количеству опрошенных по разным регионам исследования.</p>
<p>Итак, если нам нужны простые частоты, не проценты, одним из простых решений будет функция из базового R <code>table ()</code>.</p>
<p>Например, посмотрим распределение по регионам, предварительно переведя все переменные факторные, поскольку их большинство:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">as_factor</span>(df)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>Region)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Алтайский край Республика Алтай  Республика Тыва         Монголия 
             274              446              192                1 </code></pre>
</div>
</div>
<p>Если нам нужны не абсолютные, а относительные частоты по отдельным вопросам, для которых мы не собираемся делать какие-то таблицы или графики (то есть эти данные нужны только для описания), то для этой цели можно использовать , базовую функцию <code>prop.table</code>.</p>
<p>Например, мы хотим узнать пропорции по полу во всех регионах исследования (умножим на 100, чтобы получить значения в процентах, а не долях:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>V1))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Мужской  Женский 
32.07127 67.92873 </code></pre>
</div>
</div>
<p>С помощью этих же функций можно создать и двумерные таблицы:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>V1, df<span class="sc">$</span>Region), <span class="at">margin =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         
          Алтайский край Республика Алтай Республика Тыва  Монголия
  Мужской       26.66667         38.67277        24.73684   0.00000
  Женский       73.33333         61.32723        75.26316 100.00000</code></pre>
</div>
</div>
<p>Более интересный вариант предлагает функция <code>flat_table</code> (переводится как “плоская таблица”) из библиотеки <code>sjmisc</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sjmisc<span class="sc">::</span><span class="fu">flat_table</span>(df, V1, <span class="at">margin =</span> <span class="st">"cell"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>V1 Мужской Женский
                  
     32.07   67.93</code></pre>
</div>
</div>
<p>Мы видим, что в наших исследованиях приняло участие гораздо больше женщин (почти 68%), чем мужчин (35%).</p>
<p>Если нужна двумерная таблица, функция <code>flat_table</code> также подойдет (так же как и функции <code>prop.table</code>, <code>sjt.xtab</code> и другие, запомним, что в R всегда можно сделать одно и то же разными путями, здесь дело вкуса):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span>sjmisc<span class="sc">::</span><span class="fu">flat_table</span>(df, Region, V1, <span class="at">margin =</span> <span class="st">"row"</span>)<span class="co"># df - наша база данных, Region V1 - переменные для строк и столбцов, margin = "row"  - процент по строке</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 V1 Мужской Женский
Region                             
Алтайский край        26.67   73.33
Республика Алтай      38.67   61.33
Республика Тыва       24.74   75.26
Монголия               0.00  100.00</code></pre>
</div>
</div>
<p>Выглядит не очень с точки зрения оформления, зато мы быстро получили результаты и можем их описать. Видим, что женщины превалируют во всех регионах, из доля составляет более 60%, в Республике Тыва - 75%.</p>
<p>Более того, мы можем сохранить эту таблицу в формате датафрейма и потом использовать в других приложениях:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span>tidyr<span class="sc">::</span><span class="fu">as_tibble</span>(table)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  Region           V1       Freq
  &lt;fct&gt;            &lt;fct&gt;   &lt;dbl&gt;
1 Алтайский край   Мужской  26.7
2 Республика Алтай Мужской  38.7
3 Республика Тыва  Мужской  24.7
4 Монголия         Мужской   0  
5 Алтайский край   Женский  73.3
6 Республика Алтай Женский  61.3
7 Республика Тыва  Женский  75.3
8 Монголия         Женский 100  </code></pre>
</div>
</div>
<p>Если мы посмотрим, то получилось не совсем то, что нам бы хотелось: у нас получилась таблица в «длинном формате», вместо широкого. К счастью это можно быстро исправить с помощью уже знакомой нам функции <code>pivot_wider()</code>из библиотеки <code>tidyr</code>, являющейся частью экосистемы <code>tidyverse</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span>table <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> V1, <span class="at">values_from =</span> Freq)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  Region           Мужской Женский
  &lt;fct&gt;              &lt;dbl&gt;   &lt;dbl&gt;
1 Алтайский край      26.7    73.3
2 Республика Алтай    38.7    61.3
3 Республика Тыва     24.7    75.3
4 Монголия             0     100  </code></pre>
</div>
</div>
<p>Еще нам постоянно мешает это единственное наблюдение из Монголии. Давайте его уберем и пересчитаем все заново.</p>
<p>Для начала отфильтруем переменную <code>Region</code> так, чтобы в нее входили все регионы, кроме Монголии:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Присоединяю пакет: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Следующий объект скрыт от 'package:kableExtra':

    group_rows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Следующие объекты скрыты от 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Следующие объекты скрыты от 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region<span class="sc">!=</span><span class="st">"Монголия"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Попробуем сделать простую таблицу:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>Region, df<span class="sc">$</span>V1)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  
                   Мужской Женский
  Алтайский край        72     198
  Республика Алтай     169     268
  Республика Тыва       47     143
  Монголия               0       0</code></pre>
</div>
</div>
<p>Как видим, наблюдение мы удалили, но метка (уровень факторной переменной) осталась, и нам нужно его убрать. Сделать это можно с помощью функции <code>droplevels</code>. Удалим уровень и сделаем новую таблицу</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Region<span class="ot">&lt;-</span><span class="fu">droplevels</span>(df<span class="sc">$</span>Region)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>sjmisc<span class="sc">::</span><span class="fu">flat_table</span>(df, Region, V1, <span class="at">margin =</span> <span class="st">"row"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 V1 Мужской Женский
Region                             
Алтайский край        26.67   73.33
Республика Алтай      38.67   61.33
Республика Тыва       24.74   75.26</code></pre>
</div>
</div>
<p>Все получилось!</p>
<p>Между тем, очевидно, что для хорошей статьи (диссертации, отчета об исследовании) описания результатов частотного анализа недостаточно, требуется представлять результаты комплексно, сразу по нескольким переменным, часто с учетом группировки, и приводить доказательства значимости имеющихся различий на основе применения статистических методов.</p>
</section>
<section id="создание-таблиц-по-нескольким-переменным-возможности-библиотек-gtsummary-и-flextable" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="создание-таблиц-по-нескольким-переменным-возможности-библиотек-gtsummary-и-flextable"><span class="header-section-number">9.3.2</span> Создание таблиц по нескольким переменным: возможности библиотек <code>gtsummary</code> и <code>flextable</code></h3>
<ul>
<li><strong>flextable</strong> – чудо-библиотека от Дэвида Гоэля - француза и сотрудника ArData, созданная специально для работы с таблицами и улучшения их отображения в различных форматах, в частности в Word и Power Point</li>
<li><strong>gtsummary</strong> – библиотека для создания эффектных таблиц с описательными статистиками для научных публикаций</li>
</ul>
<p>Предположим, что для нашей будущей статьи, которую мы готовим по результатам исследования, мы хотим создать большую таблицу, содержащую распределения сразу по нескольким переменным, описывающим все важные демографические и социальные характеристики, такие как пол, возраст по группам, социальный статус, в том числе - с учетом региональных различий. Желательно также посчитать, являются ли эти различия значимыми, используя для этого критерий <span class="math inline">\(\chi^2\)</span> Пирсона.</p>
<p>Библиотека <code>gtsummary</code> была создана специально для того, чтобы быстро создавать гибкие с точки зрения форматирования таблицы с описательными статистиками и результатами регрессионного анализа, оформленные по стандартам для научных публикаций.</p>
<p>Настоятельно рекомендуется посетить сайт проекта и подробно ознакомиться с возможностями данной библиотеки. https://www.danieldsjoberg.com/gtsummary/index.html</p>
<p>Для начала создадим общую таблицу, где в строках будут располагаться данные по возрасту, полу, региону проживания, социальному статусу, а также наличию гражданства другой страны.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gtsummary") - убрать решетку и запустить строку</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#вспоминаем урок по dplyr</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, V1, age_cats3, V10, V6)  <span class="co">#отберем нужные переменные в отдельный сет и сохраним его под именем table</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим таблицу</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">missing=</span><span class="st">"no"</span>) <span class="co">#функция tbl_summary позволяет создать комплексные таблицы</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="hhtazeewiq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hhtazeewiq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hhtazeewiq thead, #hhtazeewiq tbody, #hhtazeewiq tfoot, #hhtazeewiq tr, #hhtazeewiq td, #hhtazeewiq th {
  border-style: none;
}

#hhtazeewiq p {
  margin: 0;
  padding: 0;
}

#hhtazeewiq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hhtazeewiq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hhtazeewiq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hhtazeewiq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hhtazeewiq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hhtazeewiq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hhtazeewiq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hhtazeewiq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hhtazeewiq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hhtazeewiq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hhtazeewiq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hhtazeewiq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hhtazeewiq .gt_spanner_row {
  border-bottom-style: hidden;
}

#hhtazeewiq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hhtazeewiq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hhtazeewiq .gt_from_md > :first-child {
  margin-top: 0;
}

#hhtazeewiq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hhtazeewiq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hhtazeewiq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hhtazeewiq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hhtazeewiq .gt_row_group_first td {
  border-top-width: 2px;
}

#hhtazeewiq .gt_row_group_first th {
  border-top-width: 2px;
}

#hhtazeewiq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhtazeewiq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hhtazeewiq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hhtazeewiq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hhtazeewiq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhtazeewiq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hhtazeewiq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hhtazeewiq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hhtazeewiq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hhtazeewiq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hhtazeewiq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhtazeewiq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hhtazeewiq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhtazeewiq .gt_left {
  text-align: left;
}

#hhtazeewiq .gt_center {
  text-align: center;
}

#hhtazeewiq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hhtazeewiq .gt_font_normal {
  font-weight: normal;
}

#hhtazeewiq .gt_font_bold {
  font-weight: bold;
}

#hhtazeewiq .gt_font_italic {
  font-style: italic;
}

#hhtazeewiq .gt_super {
  font-size: 65%;
}

#hhtazeewiq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hhtazeewiq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hhtazeewiq .gt_indent_1 {
  text-indent: 5px;
}

#hhtazeewiq .gt_indent_2 {
  text-indent: 10px;
}

#hhtazeewiq .gt_indent_3 {
  text-indent: 15px;
}

#hhtazeewiq .gt_indent_4 {
  text-indent: 20px;
}

#hhtazeewiq .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="<strong>N = 912</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 912</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Region</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Алтайский край</td>
<td class="gt_row gt_center" headers="stat_0">274 (30%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Республика Алтай</td>
<td class="gt_row gt_center" headers="stat_0">446 (49%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Республика Тыва</td>
<td class="gt_row gt_center" headers="stat_0">192 (21%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Пол</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Мужской</td>
<td class="gt_row gt_center" headers="stat_0">288 (32%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Женский</td>
<td class="gt_row gt_center" headers="stat_0">609 (68%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Возраст</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;До 30 лет</td>
<td class="gt_row gt_center" headers="stat_0">160 (18%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;31-49 лет</td>
<td class="gt_row gt_center" headers="stat_0">423 (48%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;50 лет и старше</td>
<td class="gt_row gt_center" headers="stat_0">303 (34%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Каков уровень материального достатка Вашей семьи?</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем очень бедно, фактически голодаем, денег иногда не хватает даже на питание, имевшиеся ранее накопления кончились</td>
<td class="gt_row gt_center" headers="stat_0">13 (1.5%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем бедно, денег хватает только на скромное питание, оплату коммунальных услуг,</td>
<td class="gt_row gt_center" headers="stat_0">51 (5.7%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем средне, денег хватает на питание, недорогую одежду, крайне необходимые вещи и оплату коммунальных услуг,</td>
<td class="gt_row gt_center" headers="stat_0">620 (69%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем достаточно обеспеченно, (есть денежные накопления и возможность покупать практически все необходимое для жизни)</td>
<td class="gt_row gt_center" headers="stat_0">198 (22%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Очень хорошо, богато (не отказываем себе ни в чем, денежные накопления постоянно прирастают)</td>
<td class="gt_row gt_center" headers="stat_0">14 (1.6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Какой у Вас САМЫЙ ВЫСОКИЙ уровень образования, по которому Вы получили аттестат, свидетельство, диплом?</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Основное общее образование (9 классов) или меньше</td>
<td class="gt_row gt_center" headers="stat_0">52 (5.8%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Среднее (полное) общее образование</td>
<td class="gt_row gt_center" headers="stat_0">162 (18%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Начальное или среднее профессиональное образование</td>
<td class="gt_row gt_center" headers="stat_0">294 (33%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Высшее образование (диплом специалиста, бакалавра или магистра)</td>
<td class="gt_row gt_center" headers="stat_0">382 (42%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Аспирантура, ординатура, ученая степень кандидата или доктора наук</td>
<td class="gt_row gt_center" headers="stat_0">9 (1.0%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Другое</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.1%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>В принципе, очень неплохо. Добавим группировку по региону и поменяем заголовок у переменных с “Characteristic” на “Характеристику”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by=</span>Region, <span class="at">missing=</span><span class="st">"no"</span>) <span class="sc">%&gt;%</span><span class="co">#by=V004 - так мы обозначаем группирующую переменную</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="co">#функция, позволяющая изменить заголовок</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">update =</span> <span class="fu">list</span>(</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>      label <span class="sc">~</span> <span class="st">"Характеристика"</span> <span class="co">#</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="synhosylds" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#synhosylds table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#synhosylds thead, #synhosylds tbody, #synhosylds tfoot, #synhosylds tr, #synhosylds td, #synhosylds th {
  border-style: none;
}

#synhosylds p {
  margin: 0;
  padding: 0;
}

#synhosylds .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#synhosylds .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#synhosylds .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#synhosylds .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#synhosylds .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#synhosylds .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#synhosylds .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#synhosylds .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#synhosylds .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#synhosylds .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#synhosylds .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#synhosylds .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#synhosylds .gt_spanner_row {
  border-bottom-style: hidden;
}

#synhosylds .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#synhosylds .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#synhosylds .gt_from_md > :first-child {
  margin-top: 0;
}

#synhosylds .gt_from_md > :last-child {
  margin-bottom: 0;
}

#synhosylds .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#synhosylds .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#synhosylds .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#synhosylds .gt_row_group_first td {
  border-top-width: 2px;
}

#synhosylds .gt_row_group_first th {
  border-top-width: 2px;
}

#synhosylds .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#synhosylds .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#synhosylds .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#synhosylds .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#synhosylds .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#synhosylds .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#synhosylds .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#synhosylds .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#synhosylds .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#synhosylds .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#synhosylds .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#synhosylds .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#synhosylds .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#synhosylds .gt_left {
  text-align: left;
}

#synhosylds .gt_center {
  text-align: center;
}

#synhosylds .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#synhosylds .gt_font_normal {
  font-weight: normal;
}

#synhosylds .gt_font_bold {
  font-weight: bold;
}

#synhosylds .gt_font_italic {
  font-style: italic;
}

#synhosylds .gt_super {
  font-size: 65%;
}

#synhosylds .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#synhosylds .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#synhosylds .gt_indent_1 {
  text-indent: 5px;
}

#synhosylds .gt_indent_2 {
  text-indent: 10px;
}

#synhosylds .gt_indent_3 {
  text-indent: 15px;
}

#synhosylds .gt_indent_4 {
  text-indent: 20px;
}

#synhosylds .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="Характеристика" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Характеристика</th>
<th id="<strong>Алтайский край</strong>, N = 274<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Алтайский край</strong>, N = 274<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>Республика Алтай</strong>, N = 446<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Республика Алтай</strong>, N = 446<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>Республика Тыва</strong>, N = 192<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Республика Тыва</strong>, N = 192<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Пол</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Мужской</td>
<td class="gt_row gt_center" headers="stat_1">72 (27%)</td>
<td class="gt_row gt_center" headers="stat_2">169 (39%)</td>
<td class="gt_row gt_center" headers="stat_3">47 (25%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Женский</td>
<td class="gt_row gt_center" headers="stat_1">198 (73%)</td>
<td class="gt_row gt_center" headers="stat_2">268 (61%)</td>
<td class="gt_row gt_center" headers="stat_3">143 (75%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Возраст</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;До 30 лет</td>
<td class="gt_row gt_center" headers="stat_1">35 (13%)</td>
<td class="gt_row gt_center" headers="stat_2">75 (17%)</td>
<td class="gt_row gt_center" headers="stat_3">50 (27%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;31-49 лет</td>
<td class="gt_row gt_center" headers="stat_1">114 (43%)</td>
<td class="gt_row gt_center" headers="stat_2">215 (49%)</td>
<td class="gt_row gt_center" headers="stat_3">94 (51%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;50 лет и старше</td>
<td class="gt_row gt_center" headers="stat_1">115 (44%)</td>
<td class="gt_row gt_center" headers="stat_2">147 (34%)</td>
<td class="gt_row gt_center" headers="stat_3">41 (22%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Каков уровень материального достатка Вашей семьи?</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем очень бедно, фактически голодаем, денег иногда не хватает даже на питание, имевшиеся ранее накопления кончились</td>
<td class="gt_row gt_center" headers="stat_1">4 (1.5%)</td>
<td class="gt_row gt_center" headers="stat_2">7 (1.6%)</td>
<td class="gt_row gt_center" headers="stat_3">2 (1.1%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем бедно, денег хватает только на скромное питание, оплату коммунальных услуг,</td>
<td class="gt_row gt_center" headers="stat_1">10 (3.7%)</td>
<td class="gt_row gt_center" headers="stat_2">34 (7.8%)</td>
<td class="gt_row gt_center" headers="stat_3">7 (3.7%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем средне, денег хватает на питание, недорогую одежду, крайне необходимые вещи и оплату коммунальных услуг,</td>
<td class="gt_row gt_center" headers="stat_1">193 (71%)</td>
<td class="gt_row gt_center" headers="stat_2">304 (70%)</td>
<td class="gt_row gt_center" headers="stat_3">123 (65%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Живем достаточно обеспеченно, (есть денежные накопления и возможность покупать практически все необходимое для жизни)</td>
<td class="gt_row gt_center" headers="stat_1">57 (21%)</td>
<td class="gt_row gt_center" headers="stat_2">86 (20%)</td>
<td class="gt_row gt_center" headers="stat_3">55 (29%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Очень хорошо, богато (не отказываем себе ни в чем, денежные накопления постоянно прирастают)</td>
<td class="gt_row gt_center" headers="stat_1">6 (2.2%)</td>
<td class="gt_row gt_center" headers="stat_2">5 (1.1%)</td>
<td class="gt_row gt_center" headers="stat_3">3 (1.6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Какой у Вас САМЫЙ ВЫСОКИЙ уровень образования, по которому Вы получили аттестат, свидетельство, диплом?</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Основное общее образование (9 классов) или меньше</td>
<td class="gt_row gt_center" headers="stat_1">23 (8.4%)</td>
<td class="gt_row gt_center" headers="stat_2">24 (5.5%)</td>
<td class="gt_row gt_center" headers="stat_3">5 (2.6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Среднее (полное) общее образование</td>
<td class="gt_row gt_center" headers="stat_1">37 (14%)</td>
<td class="gt_row gt_center" headers="stat_2">85 (19%)</td>
<td class="gt_row gt_center" headers="stat_3">40 (21%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Начальное или среднее профессиональное образование</td>
<td class="gt_row gt_center" headers="stat_1">80 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">173 (40%)</td>
<td class="gt_row gt_center" headers="stat_3">41 (22%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Высшее образование (диплом специалиста, бакалавра или магистра)</td>
<td class="gt_row gt_center" headers="stat_1">125 (46%)</td>
<td class="gt_row gt_center" headers="stat_2">155 (35%)</td>
<td class="gt_row gt_center" headers="stat_3">102 (54%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Аспирантура, ординатура, ученая степень кандидата или доктора наук</td>
<td class="gt_row gt_center" headers="stat_1">8 (2.9%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">1 (0.5%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Другое</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">1 (0.5%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Прочитать подробнее о функции tbl_summary, ее атрибутах, с подробным разбором примеров и возможностей изменения таблицы: http://www.danieldsjoberg.com/gtsummary/articles/tbl_summary.html</p>
<p>Можно сделать и простую двумерную таблицу:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a> table <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_cross</span>(<span class="at">row =</span> V1, <span class="at">col =</span> age_cats3, <span class="at">percent =</span> <span class="st">"cell"</span>, <span class="at">missing=</span><span class="st">"no"</span>, ) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>(<span class="at">test=</span><span class="st">"chisq.test"</span>) <span class="sc">%&gt;%</span> <span class="co">#добавляем статистику хи-квадрат</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="co">#функция, позволяющая изменить заголовок</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">update =</span> <span class="fu">list</span>(</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>      label <span class="sc">~</span> <span class="st">"**Характеристика**"</span> <span class="co">#</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Взаимосвязь пола и возраста** (N = {N})"</span>) <span class="co">#меняем заголовок на нужный, причем заголовок вставляем количество опрошенных</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>FALSE observations with missing data have been removed.</code></pre>
</div>
<div class="cell-output-display">
<div id="hvtbyeleis" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hvtbyeleis table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hvtbyeleis thead, #hvtbyeleis tbody, #hvtbyeleis tfoot, #hvtbyeleis tr, #hvtbyeleis td, #hvtbyeleis th {
  border-style: none;
}

#hvtbyeleis p {
  margin: 0;
  padding: 0;
}

#hvtbyeleis .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hvtbyeleis .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hvtbyeleis .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hvtbyeleis .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hvtbyeleis .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hvtbyeleis .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hvtbyeleis .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hvtbyeleis .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hvtbyeleis .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hvtbyeleis .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hvtbyeleis .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hvtbyeleis .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hvtbyeleis .gt_spanner_row {
  border-bottom-style: hidden;
}

#hvtbyeleis .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hvtbyeleis .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hvtbyeleis .gt_from_md > :first-child {
  margin-top: 0;
}

#hvtbyeleis .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hvtbyeleis .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hvtbyeleis .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hvtbyeleis .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hvtbyeleis .gt_row_group_first td {
  border-top-width: 2px;
}

#hvtbyeleis .gt_row_group_first th {
  border-top-width: 2px;
}

#hvtbyeleis .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvtbyeleis .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hvtbyeleis .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hvtbyeleis .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hvtbyeleis .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvtbyeleis .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hvtbyeleis .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hvtbyeleis .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hvtbyeleis .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hvtbyeleis .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hvtbyeleis .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvtbyeleis .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hvtbyeleis .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvtbyeleis .gt_left {
  text-align: left;
}

#hvtbyeleis .gt_center {
  text-align: center;
}

#hvtbyeleis .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hvtbyeleis .gt_font_normal {
  font-weight: normal;
}

#hvtbyeleis .gt_font_bold {
  font-weight: bold;
}

#hvtbyeleis .gt_font_italic {
  font-style: italic;
}

#hvtbyeleis .gt_super {
  font-size: 65%;
}

#hvtbyeleis .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hvtbyeleis .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hvtbyeleis .gt_indent_1 {
  text-indent: 5px;
}

#hvtbyeleis .gt_indent_2 {
  text-indent: 10px;
}

#hvtbyeleis .gt_indent_3 {
  text-indent: 15px;
}

#hvtbyeleis .gt_indent_4 {
  text-indent: 20px;
}

#hvtbyeleis .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Взаимосвязь пола и возраста</strong> (N = 875)</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="<strong>Характеристика</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Характеристика</strong></th>
<th colspan="3" id="Возраст" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Возраст</span></th>
<th rowspan="2" id="Total" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Total</th>
<th rowspan="2" id="p-value<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">p-value<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="До 30 лет" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">До 30 лет</th>
<th id="31-49 лет" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">31-49 лет</th>
<th id="50 лет и старше" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">50 лет и старше</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Пол</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Мужской</td>
<td class="gt_row gt_center" headers="stat_1">53 (6.1%)</td>
<td class="gt_row gt_center" headers="stat_2">127 (15%)</td>
<td class="gt_row gt_center" headers="stat_3">103 (12%)</td>
<td class="gt_row gt_center" headers="stat_0">283 (32%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Женский</td>
<td class="gt_row gt_center" headers="stat_1">106 (12%)</td>
<td class="gt_row gt_center" headers="stat_2">291 (33%)</td>
<td class="gt_row gt_center" headers="stat_3">195 (22%)</td>
<td class="gt_row gt_center" headers="stat_0">592 (68%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Total</td>
<td class="gt_row gt_center" headers="stat_1">159 (18%)</td>
<td class="gt_row gt_center" headers="stat_2">418 (48%)</td>
<td class="gt_row gt_center" headers="stat_3">298 (34%)</td>
<td class="gt_row gt_center" headers="stat_0">875 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="пример-анализа-вопроса-с-множественными-ответами" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="пример-анализа-вопроса-с-множественными-ответами"><span class="header-section-number">9.3.3</span> Пример анализа вопроса с множественными ответами</h3>
<p>Для выполнения данного задания нам понадобится <code>questionr</code> - библиотека, позволяющая анализировать таблицы с множественными ответами.</p>
<p>Прежде чем выполнить последующий код, установите пакет questionr на свой комьютер и запустите библиотеку:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("questionr") - убрать решетку и запустить строку</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>У нас в анкете был вопрос 9, в котором изучалось, чем владеет домохозяйство. Можно было выбрать несколько вариантов ответа, а также дать собственный вариант ответа - «Другое». Ответы были закодированы дихотомическим способом, выбор кодировался как 1, а его отсутствие - как 0.</p>
<p>Как в других программах статистической обработки, в R нам потребуется сделать два шага для того, чтобы проанализировать вопрос с множественным выбором: - создать набор данных, в который объединяются отдельные подвопросы; - сделать таблицу, которая может быть как одномерной, так и многомерной.</p>
<p>Давайте объединим все подвопросы вопроса V9 в один набор и сохраним его под отдельным именем - V9. Воспользуемся знакомыми нам функциями <code>select()</code> - для отбора переменных и <code>contains()</code> - отбора переменных, имена которых содержат определенный паттерн:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>V9<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"V9"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.factor)<span class="co">#дополнительный select нужен, чтобы убрать текстовую переменную «другое»</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Далее, создадим таблицу и сохраним ее в качестве отдельного датафрейма.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>V9tab<span class="ot">&lt;-</span>V9 <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">multi.table</span>(<span class="at">true.codes=</span><span class="fu">list</span>(<span class="st">"да"</span>), <span class="at">freq=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pct=</span><span class="st">`</span><span class="at">%multi</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Pct))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>V9tab</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        n  Pct
V9_2  498 54.6
V9_4  326 35.7
V9_6  312 34.2
V9_8  224 24.6
V9_10 181 19.8
V9_9  160 17.5
V9_1  135 14.8
V9_7   96 10.5
V9_13  82  9.0
V9_5   70  7.7
V9_88  45  4.9
V9_3   26  2.9
V9_11  22  2.4
V9_12   4  0.4</code></pre>
</div>
</div>
<p>Да, выглядит так себе, но зато все посчитано) сразу.</p>
<p>Поясним, что <code>true.codes=list("да")</code> - обозначаем вариант ответа, используемый для подсчета частот и процентов, <code>freq=TRUE</code> - вывод процентов, а не только частот.</p>
<p>Как добавить метки вопросов в нашу таблицу? Извлечем метки вопросов по блоку V9 в отдельное место:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>V9labs<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"V9"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_label</span>()</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>V9labs</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                       V9_1 
                                                      "Сад" 
                                                       V9_2 
                                                   "Огород" 
                                                       V9_3 
                                                   "Пасека" 
                                                       V9_4 
                                                "Транспорт" 
                                                       V9_5 
                             "Сельскохозяйственная техника" 
                                                       V9_6 
                                     "Крупный рогатый скот" 
                                                       V9_7 
                                                    "Птицы" 
                                                       V9_8 
                  "Козы, овцы, мелкий рогатый скот, свиньи" 
                                                       V9_9 
                                              "Конь (кони)" 
                                                      V9_10 
"Покосы, земельные участки для обработки (не приусадебные)" 
                                                      V9_11 
                                           "Лесные участки" 
                                                      V9_12 
                                         "Рыбное хозяйство" 
                                                      V9_13 
                                                 "Пастбище" 
                                                      V9_88 
                                                   "Другое" </code></pre>
</div>
</div>
<p>Присвоим имена в переменную <code>n</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>V9tab<span class="sc">$</span>n<span class="ot">&lt;-</span>V9labs</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>V9tab</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                              n  Pct
V9_2                                                        Сад 54.6
V9_4                                                     Огород 35.7
V9_6                                                     Пасека 34.2
V9_8                                                  Транспорт 24.6
V9_10                              Сельскохозяйственная техника 19.8
V9_9                                       Крупный рогатый скот 17.5
V9_1                                                      Птицы 14.8
V9_7                    Козы, овцы, мелкий рогатый скот, свиньи 10.5
V9_13                                               Конь (кони)  9.0
V9_5  Покосы, земельные участки для обработки (не приусадебные)  7.7
V9_88                                            Лесные участки  4.9
V9_3                                           Рыбное хозяйство  2.9
V9_11                                                  Пастбище  2.4
V9_12                                                    Другое  0.4</code></pre>
</div>
</div>
</section>
<section id="таблица-сопряженности-с-множественными-ответами" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="таблица-сопряженности-с-множественными-ответами"><span class="header-section-number">9.3.4</span> Таблица сопряженности с множественными ответами</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>V9Regiontab<span class="ot">&lt;-</span><span class="fu">cross.multi.table</span>(V9, df<span class="sc">$</span>Region, <span class="at">true.codes=</span><span class="fu">list</span>(<span class="st">"да"</span>), <span class="at">freq=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>V9Regiontab<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(V9Regiontab)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>V9Regiontab<span class="sc">$</span>n<span class="ot">&lt;-</span>V9labs</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>V9Regiontab<span class="ot">&lt;-</span>V9Regiontab <span class="sc">%&gt;%</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(n)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="графики-для-категориальных-переменных" class="level3" data-number="9.3.5">
<h3 data-number="9.3.5" class="anchored" data-anchor-id="графики-для-категориальных-переменных"><span class="header-section-number">9.3.5</span> Графики для категориальных переменных</h3>
<p>Основными графиками для категориальных переменных являются круговые и столбиковые диаграммы, а также мозаичные и ассоциативные графики, когда в анализе задействовано более двух переменных.</p>
<p>Давайте создадим такие графики для переменных по возрасту. Красивые минималистичные графики с небольшим количеством кода и исправлений можно создать с помощью библиотеки <code>ggpubr</code> от Alboukadel Kassambara (биолог, автор книг по биоинформатике и биологии рака).</p>
<p>Создадим одномерную таблицу для возраста и двумерную для взаимосвязи между полом и возрастом.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>age<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sjmisc<span class="sc">::</span><span class="fu">flat_table</span>(df, age_cats3, <span class="at">margin =</span> <span class="st">"cell"</span>, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>age_sex<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(sjmisc<span class="sc">::</span><span class="fu">flat_table</span>(df, age_cats3, V1, <span class="at">margin =</span> <span class="st">"row"</span>, <span class="at">digits =</span> <span class="dv">1</span>))</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Сделаем простую столбиковую диаграмму по возрастным группам, в качестве «изюминки» добавим красивые шрифты.</p>
<p>Прежде чем сделать сам график, установим шрифты, чтобы потом ими можно было пользоваться постоянно.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"extrafont"</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">font_import</span>()<span class="co">#шрифты устанавливаются сразу все, это может занять некоторое время</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>В результате будут импортированы следующие шрифты: <img src="http://gradientdescending.com/plots/fonttable_big.png" class="img-fluid"> После установки шрифты нужно загружать каждую сессию:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"win"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Теперь займемся самим графиком. Разберем его структуру строчка за строчкой: - <code>ggplot(data=age, aes(x=age_cats3, y=Freq)) +</code> - создаем базовый график, где по оси x у нас будут возрастные категории, а по y - проценты - <code>geom_bar(stat="identity", fill="steelblue", width = 0.6)+</code> - добавляем слой для столбиковой диаграммы, <code>stat="identity"</code> - означает, что мы будем использовать данные «как есть», а не агрегировать на основе исходных, <code>fill="steelblue"</code> - задаем цвет, <code>width = 0.6</code> - устанавливаем ширину столбцов чуть меньше обычного, для красоты)) - <code>geom_text(aes(label=scales::number(Freq,accuracy=0.1, decimal.mark = ",")),  family = "Ink Free", vjust=0.5, hjust=-0.5, color="steelblue", size=4)+</code> - тут много всего, эта часть кода отвечает за подписи к столбцам. <code>label=number(Freq,accuracy=0.1, decimal.mark = ","))</code> - устанавливаем подписи в числовом формате, запятую в качестве разделителя и округление до одного знака после запятой, <code>family = "Ink Free", vjust=0.5, hjust=-0.5</code> - задаем шрифт Ink Free, делаем выравнивание, чтобы число было ровно посредине столбца и слегка выходило за его пределы (можно поэкспериментировать с этими настройками), <code>color="steelblue", size=4</code> - эти настройки отвечают за цвет и размер текста - <code>coord_flip()</code> - переворачиваем диаграмму в горизонтальную проекцию - <code>theme_void()</code>- устанавливаем тему, в которой есть только белый фон - <code>expand_limits(y=c(0,50))</code> - раздвигаем границы по оси y, там, где проценты (это неважно, что при повороте диаграмма «ложится на бок» и оси вроде как меняются местами) - <code>theme(axis.text.y = element_text(size = 10, family = "Ink Free")</code> - устанавливаем размер и семейство шрифтов для подписей - категорий возраста - <code>scale_x_discrete(limits=rev)</code> - ну и, напоследок, меняем порядок категорий, от младшей возрастной группы к старшей</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)<span class="co">#нужна для того, чтобы отформатировать подпись</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>age, <span class="fu">aes</span>(<span class="at">x=</span>age_cats3, <span class="at">y=</span>Freq)) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">number</span>(Freq,<span class="at">accuracy=</span><span class="fl">0.1</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)),  <span class="at">family =</span> <span class="st">"Ink Free"</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">"steelblue"</span>, <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">family =</span> <span class="st">"Ink Free"</span>))<span class="sc">+</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>rev)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Добавим данные по полу. В нашем коде почти ничего не поменялось, за исключением некоторых моментов: - <code>fill=V1</code> - мы добавили в исходный график, чтобы сделать разбивку по полу - в <code>geom_bar(stat="identity", position="dodge", width = 0.6)</code> добавили <code>position="dodge"</code> - чтобы столбцы располагались рядом друг с другом, такой же аргумент добавлен и в <code>geom_text</code> - в конце появилось две новых строки <code>theme(legend.position="bottom")+  theme(legend.title=element_blank())</code>, они нужны для оформления легенды</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)<span class="co">#нужна для того, чтобы отформатировать подпись</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>age_sex, <span class="fu">aes</span>(<span class="at">x=</span>age_cats3, <span class="at">y=</span>Freq, <span class="at">fill=</span>V1)) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"dodge"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">number</span>(Freq,<span class="at">accuracy=</span><span class="fl">0.1</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)),  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.6</span>), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">family =</span> <span class="st">"Ink Free"</span>, <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">family =</span> <span class="st">"Ink Free"</span>))<span class="sc">+</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>rev)<span class="sc">+</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>В качестве альтернативы можно создать сгруппированные столбиковые диаграммы в библиотеке <code>ggstatsplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggbarstats</span>(df, <span class="at">x =</span> V1, <span class="at">y =</span> age_cats3)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>создать круговую диаграмму:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Freq, <span class="at">fill =</span> age_cats3)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">number</span>(Freq,<span class="at">accuracy=</span><span class="fl">0.1</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)), <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Возраст"</span>)) <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span><span class="co">#эта строка добавляет цветовую палитру</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Более простым решением является создание круговой диаграммы с помощью функции <code>ggpiestats</code> из библиотеки <code>ggstatsplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggpiestats</span>(df, age_cats3, <span class="at">legend.title =</span> <span class="st">"Возраст"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>С помощью этой же функции можно создать серию круговых диаграмм:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggpiestats</span>(df, V1, age_cats3)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Посмотреть отдельно хи-квадрат:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(df<span class="sc">$</span>V1, df<span class="sc">$</span>age_cats3)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  df$V1 and df$age_cats3
X-squared = 1.4769, df = 2, p-value = 0.4779</code></pre>
</div>
</div>
<p>Сделаем график для вопросов с множественными ответами, по вопросу V9. В описаниях вариантов ответов есть длинные формулировки, которые будут не очень хорошо смотреться на графике, поэтому прежде, чем создавать график, давайте уберем все, что написано в скобках, так как это скорее не основная, а уточняющая информация.</p>
<p>Для этого мы воспользуемся функцией <code>gsub</code>, в которую включим выражение, позволяющее отсечь текст, лежащий после знака <code>(</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>V9tab<span class="sc">$</span>n<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(.*"</span>, <span class="st">""</span>, V9tab<span class="sc">$</span>n)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Хотя в таблице значения отсортированы, на графике они все равно будут отображаться в том порядке, в котором представлены уровни факторной переменной. Поэтому, чтобы на графике у нас были отображены значения по убыванию (мы же не хотим, чтобы у нас получился хаос из 14 вариантов ответа), нам нужно отсортировать уровни, для чего нам потребуется библиотека <code>forcats</code>.</p>
<p>И поскольку ширина подписей, несмотря на то, что мы их сократили, будет довольно существенной, мы сделаем самые длинные подписи в две строки, что, в свою очередь, потребует работы с библиотекой <code>stringr</code> (раз это новые для нас библиотеки и мы про них не слышали, нужно их установить).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Присоединяю пакет: 'forcats'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Следующий объект скрыт от 'package:sjlabelled':

    as_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 200%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>V9tab <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">fct_reorder</span>(n, Pct)) <span class="sc">%&gt;%</span> <span class="co"># переставим местами уровни</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>Pct, <span class="at">fill=</span>n)) <span class="sc">+</span> <span class="co"># создадим типовой график</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)<span class="sc">+</span>  <span class="co"># добавим geom</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">number</span>(Pct,<span class="at">accuracy=</span><span class="fl">0.1</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">family =</span> <span class="st">"Ink Free"</span>, <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># поработаем с подписями данных</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>))<span class="sc">+</span><span class="co"># увеличим лимит оси </span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span>  <span class="co"># перевернем график в горизонтальное положение</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span>   <span class="co"># добавим минималистичную тему</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">family =</span> <span class="st">"Ink Free"</span>))<span class="sc">+</span>    <span class="co"># установим шрифт для подписей</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span>       <span class="co"># уберем легенду</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">str_wrap</span>(x, <span class="at">width =</span> <span class="dv">30</span>))       <span class="co"># Сделаем длинные подписи в несколько строк</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ExploratoryDataAnalysis_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="самостоятельная-работа" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="самостоятельная-работа"><span class="header-section-number">9.4</span> Самостоятельная работа</h2>
<ol type="1">
<li>Провести комплексную проверку на нормальность переменной <code>Sepal.Length</code> из набора `iris.</li>
<li>Провести одномерный анализ по переменным V12, V13, V15. Сделать двумерный анализ по региону и возрасту.</li>
<li>Проанализировать переменные с множественным выбором V14 и V16, также сделать двумерный анализ по региону. По всем видам анализа сделать таблицы и графики.</li>
<li>Представить все в виде отдельного документа - по желанию в каком формате.</li>
</ol>


</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Base_ggplot2.html" class="pagination-link  aria-label=" &lt;span="" визуализации="" в="" ggplot2&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Основы визуализации в ggplot2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Statistical-Inference.html" class="pagination-link" aria-label="<span class='chapter-number'>10</span>&nbsp; <span class='chapter-title'>Статистический вывод и тестирование исследовательских гипотез</span>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Статистический вывод и тестирование исследовательских гипотез</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/domelia/R-book/edit/main/ExploratoryDataAnalysis.qmd" class="toc-action"><i class="bi bi-github"></i>Редактировать страницу</a></li></ul></div></div></div></footer></body></html>